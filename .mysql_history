_HiStOrY_V2_
use\040mysql
select\040*\040from\040User;
select\040*\040from\040Users;
select\040*\040from\040users;
select\040*\040from\040user;
alter\040user\040root@localhost;
;
flush\040priviliges;
flush\040privileges;
alter\040user\040root@localhost;
create\040database\040nomadic;
grant\040all\040on\040nomadic.*\040to\040nomadic;
show\040tables;
use\040mysql
select\040User,\040Host\040from\040users;
select\040User,\040Host\040from\040user;
use\040nomadic
select\040*\040from\040vprogs;
show\040procedure\040vprogs;
show\040procedure\040status;
select\040*\040from\040mysql.proc;
use\040mysql
select\040*\040from\040proc;
show\040tables;
select\040*\040from\040procs_priv;
update\040mysql.proc\040set\040definer='nomadic'\040where\040definer='live;l
update\040mysql.proc\040set\040definer='nomadic'\040where\040definer='live;'
update\040mysql.proc\040set\040definer='nomadic'\040where\040definer='live;l\012update\040mysql.proc\040set\040definer='nomadic'\040where\040definer='live;
';
'\012';
update\040mysql.proc\040set\040definer='nomadic'\040where\040definer='live';
alter\040view\040definer=nomadic\040vprogs;
alter\040view\040definer='nomadic'\040vprogs;
grant\040all\040on\040nomadic.*\040to\040analytics;
create\040user\040analytics;
create\040user\040live;
grant\040all\040on\040nomadic.*\040to\040analytics;
grant\040all\040on\040nomadic.*\040to\040live;
select\040*\040from\040vprogs;
use\040nomadic
select\040*\040from\040vprogs;
select\040*\040from\040hostnames;
update\040hostnames\040set\040force_ssl=0;
update\040hostnames\040set\040hostname='192.168.75.149'\040where\040edition_id=71;
SELECT\040groups.program_title\040AS\040groups_program_title,\040groups.symbol\040AS\040groups_symbol,\040groups.color\040AS\040groups_color,\040groups.id\040AS\040groups_id,\040groups.program_id\040AS\040groups_program_id,\040groups.name\040AS\040groups_name,\040groups.group_set_id\040AS\040groups_group_set_id,\040groups.program_description\040AS\040groups_program_description,\040groups.start_date\040AS\040groups_start_date,\040groups.end_date\040AS\040groups_end_date,\040groups.notify_releases\040AS\040groups_notify_releases,\040groups.creator_id\040AS\040groups_creator_id,\040groups.enrolment_subject\040AS\040groups_enrolment_subject,\040groups.enrolment_message\040AS\040groups_enrolment_message,\040groups.preview\040AS\040groups_preview,\040groups.is_auto_cohort\040AS\040groups_is_auto_cohort,\040groups.include_in_all_time_leaders\040AS\040groups_include_in_all_time_leaders,\040groups.include_in_team_leaders\040AS\040groups_include_in_team_leaders,\040groups.notify_countdown_week\040AS\040groups_notify_countdown_week,\040groups.notified_countdown_week\040AS\040groups_notified_countdown_week,\040groups.notify_countdown_day\040AS\040groups_notify_countdown_day,\040groups.notified_countdown_day\040AS\040groups_notified_countdown_day,\040groups.notify_nudge\040AS\040groups_notify_nudge,\040groups.nudge_delay\040AS\040groups_nudge_delay,\040groups.default_language\040AS\040groups_default_language,\040groups.created\040AS\040groups_created,\040groups.timezone\040AS\040groups_timezone,\040groups.hide_leaderboards\040AS\040groups_hide_leaderboards,\040groups.mixed\040AS\040groups_mixed,\040groups.notify_launch\040AS\040groups_notify_launch,\040groups.notified_launch\040AS\040groups_notified_launch,\040groups.notify_followup\040AS\040groups_notify_followup,\040groups.notify_followup_delay\040AS\040groups_notify_followup_delay,\040groups.notified_followup\040AS\040groups_notified_followup,\040groups.end_action_ran\040AS\040groups_end_action_ran\040
FROM\040groups\040
WHERE\040groups.id\040=\0400
;
SELECT\040groups.program_title\040AS\040groups_program_title,\040groups.symbol\040AS\040groups_symbol,\040groups.color\040AS\040groups_color,\040groups.id\040AS\040groups_id,\040groups.program_id\040AS\040groups_program_id,\040groups.name\040AS\040groups_name,\040groups.group_set_id\040AS\040groups_group_set_id,\040groups.program_description\040AS\040groups_program_description,\040groups.start_date\040AS\040groups_start_date,\040groups.end_date\040AS\040groups_end_date,\040groups.notify_releases\040AS\040groups_notify_releases,\040groups.creator_id\040AS\040groups_creator_id,\040groups.enrolment_subject\040AS\040groups_enrolment_subject,\040groups.enrolment_message\040AS\040groups_enrolment_message,\040groups.preview\040AS\040groups_preview,\040groups.is_auto_cohort\040AS\040groups_is_auto_cohort,\040groups.include_in_all_time_leaders\040AS\040groups_include_in_all_time_leaders,\040groups.include_in_team_leaders\040AS\040groups_include_in_team_leaders,\040groups.notify_countdown_week\040AS\040groups_notify_countdown_week,\040groups.notified_countdown_week\040AS\040groups_notified_countdown_week,\040groups.notify_countdown_day\040AS\040groups_notify_countdown_day,\040groups.notified_countdown_day\040AS\040groups_notified_countdown_day,\040groups.notify_nudge\040AS\040groups_notify_nudge,\040groups.nudge_delay\040AS\040groups_nudge_delay,\040groups.default_language\040AS\040groups_default_language,\040groups.created\040AS\040groups_created,\040groups.timezone\040AS\040groups_timezone,\040groups.hide_leaderboards\040AS\040groups_hide_leaderboards,\040groups.mixed\040AS\040groups_mixed,\040groups.notify_launch\040AS\040groups_notify_launch,\040groups.notified_launch\040AS\040groups_notified_launch,\040groups.notify_followup\040AS\040groups_notify_followup,\040groups.notify_followup_delay\040AS\040groups_notify_followup_delay,\040groups.notified_followup\040AS\040groups_notified_followup,\040groups.end_action_ran\040AS\040groups_end_action_ran\040\040FROM\040groups\040\040WHERE\040groups.id\040=\0400;
select\040groups.program_title\040FROM\040groups\040WHERE\040groups.id\040=\0400;
select\040groups.program_title\040FROM\040groups\040WHERE\040groups.id\040=\0401;
select\040groups.program_title\040FROM\040groups\040WHERE\040groups.id\040=\0400;
select\040groups.program_title\040FROM\040groups\040WHERE\040groups.id\040==\0400;
select\040groups.program_title\040FROM\040groups\040WHERE\040groups.id\040=\0400;
select\040`groups`.program_title\040FROM\040`groups`\040WHERE\040`groups`.id\040=\0400;
select\040*\040from\040resource\040where\040ref='the-urgent-need-for-change-communication';
describe\040resource;
select\040cast(binary(brief)\040as\040varchar\040charset=utf8)\040from\040resource\040where\040id=1398;
select\040cast(binary(brief)\040as\040charset=utf8)\040from\040resource\040where\040id=1398;
select\040cast(binary(brief)\040as\040char\040character\040set\040utf8)\040from\040resource\040where\040id=1398;
update\040resource\040set\040brief=cast(binary(brief)\040as\040char\040character\040set\040utf8)\040from\040resource\040where\040id=1398;
update\040resource\040set\040brief=cast(binary(brief)\040as\040char\040character\040set\040utf8)\040where\040id=1398;
update\040resource_version\040set\040content=cast(binary(content)\040as\040char\040character\040set\040utf8)\040where\040ref='the-urgent-need-for-change-communication';
select\040cast(binary(brief)\040as\040char\040character\040set\040utf8)\040from\040resource\040where\040id=1398;
describe\040resource_version;
update\040resource_version\040set\040content=cast(binary(content)\040as\040char\040character\040set\040utf8)\040where\040ref!='the-urgent-need-for-change-communication';
select\040binary(title)\040from\040resource\040where\040id=837;
describe\040resource;
select\040title\040from\040resource\040where\040id=837;
update\040hostnames\040set\040hostname='192.168.75.149'\040where\040edition_id=52;
select\040*\040from\040hostnames;
update\040hostnames\040set\040hostname=replace(hostname,\040'nomadic.fm',\040'nomadic.local');
select\040*\040from\040hostnames;
update\040hostnames\040set\040hostname='bersin.nomadic.local'\040where\040edition_id=71;
update\040hostnames\040set\040hostname='app.nomadic.local'\040where\040edition_id=52;
select\040count(*)\040from\040pageviews;
use\040nomadic;
select\040count(*)\040from\040pageviews;
delete\040from\040pageviews\040where\040viewed\040<\040'2020-01-01'\040limit\040100;
innodb\040status
;
show\040engine\040innodb\040status;
show\040engine\040innodb\040status\134G
show\040engine\040innodb\040status;
show\040engine\040innodb\040status\134G
select\040count(*)\040from\040pageviews;
show\040engine\040innodb\040status\134G
select\040count(*)\040from\040pageviews;
delete\040from\040pageviews\040where\040viewed\040<\040'2020-01-01'\040limit\040100;
delete\040from\040pageviews\040where\040viewed\040<\040'2020-01-01'\040limit\0401000;
delete\040from\040pageviews\040where\040viewed\040<\040'2020-01-01'\040limit\04010000;
delete\040from\040pageviews\040where\040viewed\040<\040'2020-01-01'\040limit\040100000;
delete\040from\040pageviews\040where\040viewed\040<\040'2020-01-01'\040limit\0401000000;
select\040count(*)\040from\040pageviews;
delete\040from\040pageviews\040where\040viewed\040<\040'2020-01-01';
optimize\040pageviews;
optimize\040table\040pageviews;
optimize\040table\040comments;
show\040global\040parameters;
show\040global\040variables;
alter\040table\040comment
\134c
alter\040table\040comment\040
alter\040table\040comments\040row_format=compressed\040key_block_size=4;
optimize\040table\040program_completion_log;
optimize\040table\040pointslog;
optimize\040table\040pollresponses;
optimize\040table\040quizresponses;
optimize\040table\040viewtimelog;
optimize\040table\040textboxes_version;
optimize\040table\040videoprogress;
delete\040from\040fmlog\040where\040requested\040<\040'2020-01-01';;
optimize\040table\040fmlog;
delete\040from\040fmlog\040where\040posted\040<\040'2020-01-01';
delete\040from\040fmlog\040where\040posted\040<\040'2020-01-01'\040limit\04010000;
select\040count(*)\040from\040fmlog;
delete\040from\040fmlog\040where\040posted\040<\040'2020-01-01'\040limit\040100000;
select\040count(*)\040from\040fmlog;
delete\040from\040fmlog\040where\040posted\040<\040'2020-01-01'\040limit\040100000;
delete\040from\040fmlog\040where\040posted\040<\040'2020-01-01'\040limit\040500000;
select\040count(*)\040from\040fmlog;
optimize\040table\040fmlog;
optimize\040table\040notification;
optimize\040table\040commentvotes;
optimize\040table\040analytics_completion;
delete\040from\040saml_request_log\040where\040requested\040<\040'2020-01-01';;
optimize\040table\040saml_request_log;
delete\040a\040from\040saml_request_log\040a\040left\040join\040saml_response_log\040b\040on\040b.request_id\040=\040a.id\040where\040requested\040<\040'2021-01-01'\040and\040b.id\040is\040null\040limit\04010000;
delete\040a\040from\040saml_request_log\040a\040left\040join\040saml_response_log\040b\040on\040b.request_id\040=\040a.id\040where\040requested\040<\040'2021-01-01'\040and\040b.id\040is\040null;
optimize\040table\040saml_request_log;
delete\040from\040saml_response_log\040where\040received\040<\040'2020-01-01';
delete\040a\040from\040saml_request_log\040a\040left\040join\040saml_response_log\040b\040on\040b.request_id\040=\040a.id\040where\040requested\040<\040'2021-01-01'\040and\040b.id\040is\040null;
optimize\040table\040saml_request_log;
optimize\040table\040saml_response_log;
optimize\040table\040quizlog;
optimize\040table\040analytics_active_users;
alter\040table\040saml_request\040row_format=compressed\040key_block_size=4;
alter\040table\040saml_request_log\040row_format=compressed\040key_block_size=4;
alter\040table\040saml_request_log\040row_format=compressed\040key_block_size=8;
optimize\040table\040saml_request_log;
alter\040table\040comments\040row_format=compressed\040key_block_size=8;
alter\040table\040comments\040row_format=compressed\040key_block_size=2;
alter\040table\040program_completion_log\040row_format=compressed\040key_block_size=8;
alter\040table\040completion_log\040row_format=compressed\040key_block_size=8;
alter\040table\040completionlog\040row_format=compressed\040key_block_size=8;
alter\040table\040completpageviews\040roat=compressed\040key_block_size=8;\134c
alter\040table\040pageviews\040row_format=compressed\040key_block_size=8;
purge\040binary\040logs\040before\040'2021-03-18';
select\040count(*)\040from\040pageviews;
purge\040binary\040logs\040before\040'2021-03-18';
show\040warnings;
update\040hostnames\040set\040hostname=[Freplace(hostname,\040'nomadic.local',\040'nomadicvm.local');
update\040hostnames\040set\040hostname=replace(hostname,\040'nomadic.local',\040'nomadicvm.local');
update\040logins\040set\040email='dummy@example.com'\040where\040id\040in\040(213196,\040338652,\040338653,\040338654,\040338655,\040338656,\040338657,\040338658,\040338659,\040338660,\040338661,\040338662,\040338663,\040338664,\040338665,\040338666,\040338667,\040338668,\040338669);
select\040*\040from\040hostnames;
update\040hostnames\040set\040hostname=replace(hostname,\040'nomadicvm.local',\040'nomadic.local');
insert\040into\040group_set(name,\040program_id,\040public)\040values('Alcon',\0407462,\0400)
;
update\040groups\040set\040group_set_id=last_insert_id()\040where\040id=17313;
update\040`groups`\040set\040group_set_id=last_insert_id()\040where\040id=17313;
insert\040into\040auto_cohort(program_id,\040token,\040user_cap,\040group_name_prefix,\040time_bound,\040group_set_id,\040subscription_id)\040values(7462,\040'alcon-shrbp',\0401,\040'Alcon\040Team',\0401621,\0405412);
insert\040into\040auto_cohort(program_id,\040token,\040user_cap,\040group_name_prefix,\040time_bound,\040group_set_id,\040subscription_id)\040values(7462,\040'alcon-shrbp',\0401,\040'Alcon\040Team',\0400,\0401621,\0405412);
update\040saml_provider\040set\040subscription_id=5412\040where\040id=43;
select\040*\040from\040auto_cohort;
call\040eraseuser(375734);
update\040[Fsaml_provider\040set\040subscription_id=null\040where\040id=43;
update\040saml_provider\040set\040subscription_id=null\040where\040id=43;
update\040saml_provider\040set\040subscription_id=305\040where\040id=43;
select\040*\040from\040auto_cohort;
update\040auto_cohort\040set\040token='DEFAULT'\040where\040id=182;
delete\040from\040auto_cohort\040where\040token='DEFAULT';
update\040auto_cohort\040set\040token='DEFAULT'\040where\040id=182;
select\040*\040from\040hostnamesl
;
select\040*\040from\040hostnames;
[Fupdate\040hostnames\040set\040hostname=replace(hostname,\040'nomadic.local',\040'nomadicvm.local');
update\040hostnames\040set\040hostname=replace(hostname,\040'nomadic.local',\040'nomadicvm.local');
select\040*\040from\040resource_publication\040where\040resource_id=1399;
SELECT\040l.user_id,\040program_id,\040MAX(posted),\040MAX(value)
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id
GROUP\040BY\040l.user_id,\040program_id;
SELECT\040l.user_id,\040program_id,\040MAX(posted),\040MAX(value)\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id\040GROUP\040BY\040l.user_id,\040program_id;
SELECT\040l.user_id,\040program_id,\040MAX(posted),\040MAX(value)
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
GROUP\040BY\040l.user_id,\040program_id;
SELECT\040l.user_id,\040program_id,\040MAX(posted),\040MAX(value)\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040GROUP\040BY\040l.user_id,\040program_id;
SELECT\040l.user_id,\040program_id,\040MAX(posted),\040MAX(value)
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
GROUP\040BY\040l.user_id,\040program_id
LIMIT\04010;
SELECT\040l.user_id,\040program_id,\040MAX(posted),\040MAX(value)\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040GROUP\040BY\040l.user_id,\040program_id\040LIMIT\04010;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted),\040MAX(value)
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted),\040MAX(value)\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted\040last_updated),\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted\040last_updated),\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted\040last_updated),\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted\040last_updated),\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040u.first_name,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
SELECT\040u.first_name,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id;
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id;
)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id;
SELECT\040u.first_name,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id;
SELECT\040u.first_name,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id;
SELECT\040u.first_name,\040p.title,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id;
SELECT\040u.first_name,\040p.title,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id;
SELECT\040u.first_name,\040p.title,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040psu.added,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040psu.added,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040psu.created,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040psu.created,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
describe\040program_session_user;
SELECT\040u.first_name,\040p.title,\040psu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040psu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040psu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
INNER\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040psu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040INNER\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040psu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040psu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id
LIMIT\04010;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040LIMIT\04010;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id
LIMIT\040100;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040LIMIT\040100;
SELECT\040u.first_name,\040p.title,\040COALESCE(psu.added,\040gu.added),\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id
LIMIT\040100;
SELECT\040u.first_name,\040p.title,\040COALESCE(psu.added,\040gu.added),\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040LIMIT\040100;
select\040*\040from\040program_session_user\040where\040user_Id=344212\040and\040program_id=7462;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id
LIMIT\04010;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040LIMIT\04010;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040=\040c.program_id
LIMIT\04010;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040=\040c.program_id\040LIMIT\04010;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*
FROM
(
SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion
FROM\040program_completion_log\040l
\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id
\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id
WHERE\040i.subscription_id\040=\0403912
GROUP\040BY\040l.user_id,\040l.group_id,\040program_id
)\040c
INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id
INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id
INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id
LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040=\040c.program_id
;
SELECT\040u.first_name,\040p.title,\040psu.added,\040gu.added,\040c.*\040FROM\040(\040SELECT\040l.user_id,\040l.group_id,\040program_id,\040MAX(posted)\040last_updated,\040MAX(value)\040completion\040FROM\040program_completion_log\040l\040\040\040\040\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040l.user_id\040AND\040gu.group_id\040=\040l.group_id\040\040\040\040\040INNER\040JOIN\040`groups`\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040INNER\040JOIN\040platform_subscription_invitation\040i\040ON\040i.user_id\040=\040l.user_id\040WHERE\040i.subscription_id\040=\0403912\040GROUP\040BY\040l.user_id,\040l.group_id,\040program_id\040)\040c\040INNER\040JOIN\040users\040u\040ON\040u.id\040=\040c.user_id\040INNER\040JOIN\040programs\040p\040ON\040p.id\040=\040c.program_id\040INNER\040JOIN\040groupusers\040gu\040ON\040gu.user_id\040=\040c.user_id\040and\040gu.group_id\040=\040c.group_id\040LEFT\040JOIN\040program_session_user\040psu\040ON\040psu.user_id\040=\040u.id\040AND\040psu.program_id\040=\040c.program_id;
insert\040into\040team_name_scheme(ref,\040name)\040values('mountains',\040'Mountains');
insert\040into\040team_name_word(scheme_ref,\040word)\040values
('mountains',\040'Chersky\040Range'),
('mountains',\040'Eastern\040Alps'),
('mountains',\040'Serra\040do\040Mar'),
('mountains',\040'Barisan\040Mountains');
insert\040into\040team_name_word(scheme_ref,\040word)\040values\040('mountains',\040'Chersky\040Range'),\040('mountains',\040'Eastern\040Alps'),\040('mountains',\040'Serra\040do\040Mar'),\040('mountains',\040'Barisan\040Mountains');
select\040*\040from\040access_role_permission;
insert\040into\040access_role(name,\040description,\040applicable_scopes_bitfield)\040values('Analytics',\040'Analytics\040Access',\04063);
insert\040into\040access_role_group(access_role_name,\040access_group_name,\040scoped_target_type)\040values('Analytics',\040'DevTeam',\040'global');
insert\040into\040access_role_permission(access_role_name,\040permission)\040values('Analytics',\040'read_community_data');
insert\040into\040access_role_permission(access_role_name,\040permission)\040values('Analytics',\040'read_community_summary_data');
select\040*\040from\040user_role;
select\040*\040from\040access_group_user;
select\040*\040from\040access_group_role;
select\040*\040from\040access_role_group;
select\040*\040from\040access_role_permission;
select\040*\040from\040access_group_user;
select\040*\040from\040access_group_user\040where\040user_id=180326;
select\040*\040from\040ProgramSessionNameScheme
;
select\040*\040from\040program_session_name_scheme;
insert\040into\040team_name_scheme(ref,\040name)\040values
('mountains',\040'Mountains');
insert\040into\040team_name_scheme(ref,\040name)\040values\040('mountains',\040'Mountains');
insert\040into\040team_name_word(scheme_ref,\040word)\040values
('mountains',\040'Barisan\040Mountains'),
('mountains',\040'Chersky\040Range'),
('mountains',\040'Eastern\040Alps'),
('mountains',\040'Serra\040do\040Mar');
insert\040into\040team_name_word(scheme_ref,\040word)\040values\040('mountains',\040'Barisan\040Mountains'),\040('mountains',\040'Chersky\040Range'),\040('mountains',\040'Eastern\040Alps'),\040('mountains',\040'Serra\040do\040Mar');
insert\040into\040program_session_name_scheme(scheme_ref,\040session_id)\040values
('mountains',\040235);
insert\040into\040program_session_name_scheme(scheme_ref,\040session_id)\040values\040('mountains',\040235);
insert\040into\040hostnames(hostname,\040edition_id,\040force_ssl)\040values('192.168.75.149',\04071,\0400);
update\040hostnames\040set\040hostname=replace(hostname,\040'nomadicvm.local',\040'nomadic.local');
create\040database\040nomadic_testing;
grant\040all\040on\040nomadic_testing.*\040to\040nomadic;
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com';
use\040nomadic;
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com';
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com'\040and\040u.edition_id=71;
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com'\040and\040u.edition_id=71\134G
begin;
commit;
SELECT
\040\040\040\040editions.language_codes\040AS\040editions_language_codes,
\040\040\040\040editions.id\040AS\040editions_id,
\040\040\040\040editions.name\040AS\040editions_name,
\040\040\040\040editions.brand_id\040AS\040editions_brand_id,
\040\040\040\040editions.created\040AS\040editions_created,
\040\040\040\040editions.starts\040AS\040editions_starts,
\040\040\040\040editions.expires\040AS\040editions_expires,
\040\040\040\040editions.intro_title\040AS\040editions_intro_title,
\040\040\040\040editions.header_title\040AS\040editions_header_title,
\040\040\040\040editions.intro_menu_title\040AS\040editions_intro_menu_title,
\040\040\040\040editions.introduction\040AS\040editions_introduction,
\040\040\040\040editions.introduction_admin\040AS\040editions_introduction_admin,
\040\040\040\040editions.use_cohorts\040AS\040editions_use_cohorts,
\040\040\040\040editions.enable_payment\040AS\040editions_enable_payment,
\040\040\040\040editions.send_registration_notifications\040AS\040editions_send_registration_notifications,
\040\040\040\040editions.header_logo\040AS\040editions_header_logo,
\040\040\040\040editions.intro_logo\040AS\040editions_intro_logo,
\040\040\040\040editions.intro_video_placeholder\040AS\040editions_intro_video_placeholder,
\040\040\040\040editions.intro_video_ref\040AS\040editions_intro_video_ref,
\040\040\040\040editions.intro_video_id\040AS\040editions_intro_video_id,
\040\040\040\040editions.enable_resource_library\040AS\040editions_enable_resource_library,
\040\040\040\040editions.resources_admin_only\040AS\040editions_resources_admin_only,
\040\040\040\040editions.enable_program_wide_conversations\040AS\040editions_enable_program_wide_conversations,
\040\040\040\040editions.profile_disclaimer\040AS\040editions_profile_disclaimer,
\040\040\040\040editions.lock_user_name\040AS\040editions_lock_user_name,
\040\040\040\040editions.show_email_in_profile\040AS\040editions_show_email_in_profile,
\040\040\040\040editions.show_profile_dialog\040AS\040editions_show_profile_dialog,
\040\040\040\040editions.enable_comment_moderation\040AS\040editions_enable_comment_moderation,
\040\040\040\040editions.disable_comment_links\040AS\040editions_disable_comment_links,
\040\040\040\040editions.timezone\040AS\040editions_timezone,
\040\040\040\040editions.licenses\040AS\040editions_licenses,
\040\040\040\040editions.skip_edition_welcome\040AS\040editions_skip_edition_welcome,
\040\040\040\040editions.dark_text\040AS\040editions_dark_text,
\040\040\040\040editions.about_content\040AS\040editions_about_content,
\040\040\040\040editions.custom_css\040AS\040editions_custom_css,
\040\040\040\040editions.privacy_notice\040AS\040editions_privacy_notice,
\040\040\040\040editions.send_mass_conversation_notifications\040AS\040editions_send_mass_conversation_notifications,
\040\040\040\040editions.enable_document_library\040AS\040editions_enable_document_library,
\040\040\040\040editions.video_source\040AS\040editions_video_source,
\040\040\040\040editions.must_comment_in_all_debates\040AS\040editions_must_comment_in_all_debates,
\040\040\040\040editions.yourlearning_id\040AS\040editions_yourlearning_id,
\040\040\040\040editions.mixed\040AS\040editions_mixed,
\040\040\040\040editions.enable_community\040AS\040editions_enable_community,
\040\040\040\040editions.community_edition_id\040AS\040editions_community_edition_id,
\040\040\040\040editions.community_terms_popup\040AS\040editions_community_terms_popup,
\040\040\040\040editions.community_terms_page\040AS\040editions_community_terms_page,
\040\040\040\040editions.community_expert_flair\040AS\040editions_community_expert_flair,
\040\040\040\040editions.community_expert_label\040AS\040editions_community_expert_label,
\040\040\040\040editions.guide_video_id\040AS\040editions_guide_video_id,
\040\040\040\040editions.email_header_image\040AS\040editions_email_header_image,
\040\040\040\040editions.always_allow_resources\040AS\040editions_always_allow_resources,
\040\040\040\040editions.enable_open_registration\040AS\040editions_enable_open_registration,
\040\040\040\040editions.enable_invite_links\040AS\040editions_enable_invite_links,
\040\040\040\040editions.stripe_secret_key\040AS\040editions_stripe_secret_key,
\040\040\040\040editions.stripe_publishable_key\040AS\040editions_stripe_publishable_key,
\040\040\040\040editions.enable_channels\040AS\040editions_enable_channels,
\040\040\040\040editions.enable_create_channels\040AS\040editions_enable_create_channels,
\040\040\040\040editions.enable_public_channels\040AS\040editions_enable_public_channels,
\040\040\040\040editions.community_share_message\040AS\040editions_community_share_message,
\040\040\040\040editions.email_notification_header_paragraph\040AS\040editions_email_notification_header_paragraph,
\040\040\040\040editions.email_notification_footer_paragraph\040AS\040editions_email_notification_footer_paragraph,
\040\040\040\040editions.email_notification_sign_off\040AS\040editions_email_notification_sign_off,
\040\040\040\040editions.email_notification_sender_address\040AS\040editions_email_notification_sender_address,
\040\040\040\040editions.email_notification_sender_name\040AS\040editions_email_notification_sender_name,
\040\040\040\040editions.show_generic_journeys\040AS\040editions_show_generic_journeys,
\040\040\040\040editions.redirect_on_idle\040AS\040editions_redirect_on_idle,
\040\040\040\040editions.internal_name\040AS\040editions_internal_name,
\040\040\040\040editions.disable_attachments\040AS\040editions_disable_attachments,
\040\040\040\040editions.override_program_sort_order\040AS\040editions_override_program_sort_order,
\040\040\040\040editions.require_payment_by_default\040AS\040editions_require_payment_by_default,
\040\040\040\040editions.gtm_container_id\040AS\040editions_gtm_container_id,
\040\040\040\040editions.tracking_snippet\040AS\040editions_tracking_snippet,
\040\040\040\040editions.acronym\040AS\040editions_acronym,
\040\040\040\040editions.email_tracking_domain\040AS\040editions_email_tracking_domain,
\040\040\040\040editions.send_welcome_notification\040AS\040editions_send_welcome_notification,
\040\040\040\040editions.welcome_notification_content\040AS\040editions_welcome_notification_content,
\040\040\040\040editions.post_program_survey_id\040AS\040editions_post_program_survey_id,
\040\040\040\040editions.enabled\040AS\040editions_enabled,
\040\040\040\040editions.helpdesk_type\040AS\040editions_helpdesk_type,
\040\040\040\040editions.helpdesk_location\040AS\040editions_helpdesk_location,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id
;
use\040nomadic;
SELECT
\040\040\040\040editions.language_codes\040AS\040editions_language_codes,
\040\040\040\040editions.id\040AS\040editions_id,
\040\040\040\040editions.name\040AS\040editions_name,
\040\040\040\040editions.brand_id\040AS\040editions_brand_id,
\040\040\040\040editions.created\040AS\040editions_created,
\040\040\040\040editions.starts\040AS\040editions_starts,
\040\040\040\040editions.expires\040AS\040editions_expires,
\040\040\040\040editions.intro_title\040AS\040editions_intro_title,
\040\040\040\040editions.header_title\040AS\040editions_header_title,
\040\040\040\040editions.intro_menu_title\040AS\040editions_intro_menu_title,
\040\040\040\040editions.introduction\040AS\040editions_introduction,
\040\040\040\040editions.introduction_admin\040AS\040editions_introduction_admin,
\040\040\040\040editions.use_cohorts\040AS\040editions_use_cohorts,
\040\040\040\040editions.enable_payment\040AS\040editions_enable_payment,
\040\040\040\040editions.send_registration_notifications\040AS\040editions_send_registration_notifications,
\040\040\040\040editions.header_logo\040AS\040editions_header_logo,
\040\040\040\040editions.intro_logo\040AS\040editions_intro_logo,
\040\040\040\040editions.intro_video_placeholder\040AS\040editions_intro_video_placeholder,
\040\040\040\040editions.intro_video_ref\040AS\040editions_intro_video_ref,
\040\040\040\040editions.intro_video_id\040AS\040editions_intro_video_id,
\040\040\040\040editions.enable_resource_library\040AS\040editions_enable_resource_library,
\040\040\040\040editions.resources_admin_only\040AS\040editions_resources_admin_only,
\040\040\040\040editions.enable_program_wide_conversations\040AS\040editions_enable_program_wide_conversations,
\040\040\040\040editions.profile_disclaimer\040AS\040editions_profile_disclaimer,
\040\040\040\040editions.lock_user_name\040AS\040editions_lock_user_name,
\040\040\040\040editions.show_email_in_profile\040AS\040editions_show_email_in_profile,
\040\040\040\040editions.show_profile_dialog\040AS\040editions_show_profile_dialog,
\040\040\040\040editions.enable_comment_moderation\040AS\040editions_enable_comment_moderation,
\040\040\040\040editions.disable_comment_links\040AS\040editions_disable_comment_links,
\040\040\040\040editions.timezone\040AS\040editions_timezone,
\040\040\040\040editions.licenses\040AS\040editions_licenses,
\040\040\040\040editions.skip_edition_welcome\040AS\040editions_skip_edition_welcome,
\040\040\040\040editions.dark_text\040AS\040editions_dark_text,
\040\040\040\040editions.about_content\040AS\040editions_about_content,
\040\040\040\040editions.custom_css\040AS\040editions_custom_css,
\040\040\040\040editions.privacy_notice\040AS\040editions_privacy_notice,
\040\040\040\040editions.send_mass_conversation_notifications\040AS\040editions_send_mass_conversation_notifications,
\040\040\040\040editions.enable_document_library\040AS\040editions_enable_document_library,
\040\040\040\040editions.video_source\040AS\040editions_video_source,
\040\040\040\040editions.must_comment_in_all_debates\040AS\040editions_must_comment_in_all_debates,
\040\040\040\040editions.yourlearning_id\040AS\040editions_yourlearning_id,
\040\040\040\040editions.mixed\040AS\040editions_mixed,
\040\040\040\040editions.enable_community\040AS\040editions_enable_community,
\040\040\040\040editions.community_edition_id\040AS\040editions_community_edition_id,
\040\040\040\040editions.community_terms_popup\040AS\040editions_community_terms_popup,
\040\040\040\040editions.community_terms_page\040AS\040editions_community_terms_page,
\040\040\040\040editions.community_expert_flair\040AS\040editions_community_expert_flair,
\040\040\040\040editions.community_expert_label\040AS\040editions_community_expert_label,
\040\040\040\040editions.guide_video_id\040AS\040editions_guide_video_id,
\040\040\040\040editions.email_header_image\040AS\040editions_email_header_image,
\040\040\040\040editions.always_allow_resources\040AS\040editions_always_allow_resources,
\040\040\040\040editions.enable_open_registration\040AS\040editions_enable_open_registration,
\040\040\040\040editions.enable_invite_links\040AS\040editions_enable_invite_links,
\040\040\040\040editions.stripe_secret_key\040AS\040editions_stripe_secret_key,
\040\040\040\040editions.stripe_publishable_key\040AS\040editions_stripe_publishable_key,
\040\040\040\040editions.enable_channels\040AS\040editions_enable_channels,
\040\040\040\040editions.enable_create_channels\040AS\040editions_enable_create_channels,
\040\040\040\040editions.enable_public_channels\040AS\040editions_enable_public_channels,
\040\040\040\040editions.community_share_message\040AS\040editions_community_share_message,
\040\040\040\040editions.email_notification_header_paragraph\040AS\040editions_email_notification_header_paragraph,
\040\040\040\040editions.email_notification_footer_paragraph\040AS\040editions_email_notification_footer_paragraph,
\040\040\040\040editions.email_notification_sign_off\040AS\040editions_email_notification_sign_off,
\040\040\040\040editions.email_notification_sender_address\040AS\040editions_email_notification_sender_address,
\040\040\040\040editions.email_notification_sender_name\040AS\040editions_email_notification_sender_name,
\040\040\040\040editions.show_generic_journeys\040AS\040editions_show_generic_journeys,
\040\040\040\040editions.redirect_on_idle\040AS\040editions_redirect_on_idle,
\040\040\040\040editions.internal_name\040AS\040editions_internal_name,
\040\040\040\040editions.disable_attachments\040AS\040editions_disable_attachments,
\040\040\040\040editions.override_program_sort_order\040AS\040editions_override_program_sort_order,
\040\040\040\040editions.require_payment_by_default\040AS\040editions_require_payment_by_default,
\040\040\040\040editions.gtm_container_id\040AS\040editions_gtm_container_id,
\040\040\040\040editions.tracking_snippet\040AS\040editions_tracking_snippet,
\040\040\040\040editions.acronym\040AS\040editions_acronym,
\040\040\040\040editions.email_tracking_domain\040AS\040editions_email_tracking_domain,
\040\040\040\040editions.send_welcome_notification\040AS\040editions_send_welcome_notification,
\040\040\040\040editions.welcome_notification_content\040AS\040editions_welcome_notification_content,
\040\040\040\040editions.post_program_survey_id\040AS\040editions_post_program_survey_id,
\040\040\040\040editions.enabled\040AS\040editions_enabled,
\040\040\040\040editions.helpdesk_type\040AS\040editions_helpdesk_type,
\040\040\040\040editions.helpdesk_location\040AS\040editions_helpdesk_location,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id;
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
;'
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id;
SELECT
\040\040\040\040editions.language_codes\040AS\040editions_language_codes,
\040\040\040\040editions.id\040AS\040editions_id,
\040\040\040\040editions.name\040AS\040editions_name,
\040\040\040\040editions.brand_id\040AS\040editions_brand_id,
\040\040\040\040editions.created\040AS\040editions_created,
\040\040\040\040editions.starts\040AS\040editions_starts,
\040\040\040\040editions.expires\040AS\040editions_expires,
\040\040\040\040editions.intro_title\040AS\040editions_intro_title,
\040\040\040\040editions.header_title\040AS\040editions_header_title,
\040\040\040\040editions.intro_menu_title\040AS\040editions_intro_menu_title,
\040\040\040\040editions.introduction\040AS\040editions_introduction,
\040\040\040\040editions.introduction_admin\040AS\040editions_introduction_admin,
\040\040\040\040editions.use_cohorts\040AS\040editions_use_cohorts,
\040\040\040\040editions.enable_payment\040AS\040editions_enable_payment,
\040\040\040\040editions.send_registration_notifications\040AS\040editions_send_registration_notifications,
\040\040\040\040editions.header_logo\040AS\040editions_header_logo,
\040\040\040\040editions.intro_logo\040AS\040editions_intro_logo,
\040\040\040\040editions.intro_video_placeholder\040AS\040editions_intro_video_placeholder,
\040\040\040\040editions.intro_video_ref\040AS\040editions_intro_video_ref,
\040\040\040\040editions.intro_video_id\040AS\040editions_intro_video_id,
\040\040\040\040editions.enable_resource_library\040AS\040editions_enable_resource_library,
\040\040\040\040editions.resources_admin_only\040AS\040editions_resources_admin_only,
\040\040\040\040editions.enable_program_wide_conversations\040AS\040editions_enable_program_wide_conversations,
\040\040\040\040editions.profile_disclaimer\040AS\040editions_profile_disclaimer,
\040\040\040\040editions.lock_user_name\040AS\040editions_lock_user_name,
\040\040\040\040editions.show_email_in_profile\040AS\040editions_show_email_in_profile,
\040\040\040\040editions.show_profile_dialog\040AS\040editions_show_profile_dialog,
\040\040\040\040editions.enable_comment_moderation\040AS\040editions_enable_comment_moderation,
\040\040\040\040editions.disable_comment_links\040AS\040editions_disable_comment_links,
\040\040\040\040editions.timezone\040AS\040editions_timezone,
\040\040\040\040editions.licenses\040AS\040editions_licenses,
\040\040\040\040editions.skip_edition_welcome\040AS\040editions_skip_edition_welcome,
\040\040\040\040editions.dark_text\040AS\040editions_dark_text,
\040\040\040\040editions.about_content\040AS\040editions_about_content,
\040\040\040\040editions.custom_css\040AS\040editions_custom_css,
\040\040\040\040editions.privacy_notice\040AS\040editions_privacy_notice,
\040\040\040\040editions.send_mass_conversation_notifications\040AS\040editions_send_mass_conversation_notifications,
\040\040\040\040editions.enable_document_library\040AS\040editions_enable_document_library,
\040\040\040\040editions.video_source\040AS\040editions_video_source,
\040\040\040\040editions.must_comment_in_all_debates\040AS\040editions_must_comment_in_all_debates,
\040\040\040\040editions.yourlearning_id\040AS\040editions_yourlearning_id,
\040\040\040\040editions.mixed\040AS\040editions_mixed,
\040\040\040\040editions.enable_community\040AS\040editions_enable_community,
\040\040\040\040editions.community_edition_id\040AS\040editions_community_edition_id,
\040\040\040\040editions.community_terms_popup\040AS\040editions_community_terms_popup,
\040\040\040\040editions.community_terms_page\040AS\040editions_community_terms_page,
\040\040\040\040editions.community_expert_flair\040AS\040editions_community_expert_flair,
\040\040\040\040editions.community_expert_label\040AS\040editions_community_expert_label,
\040\040\040\040editions.guide_video_id\040AS\040editions_guide_video_id,
\040\040\040\040editions.email_header_image\040AS\040editions_email_header_image,
\040\040\040\040editions.always_allow_resources\040AS\040editions_always_allow_resources,
\040\040\040\040editions.enable_open_registration\040AS\040editions_enable_open_registration,
\040\040\040\040editions.enable_invite_links\040AS\040editions_enable_invite_links,
\040\040\040\040editions.stripe_secret_key\040AS\040editions_stripe_secret_key,
\040\040\040\040editions.stripe_publishable_key\040AS\040editions_stripe_publishable_key,
\040\040\040\040editions.enable_channels\040AS\040editions_enable_channels,
\040\040\040\040editions.enable_create_channels\040AS\040editions_enable_create_channels,
\040\040\040\040editions.enable_public_channels\040AS\040editions_enable_public_channels,
\040\040\040\040editions.community_share_message\040AS\040editions_community_share_message,
\040\040\040\040editions.email_notification_header_paragraph\040AS\040editions_email_notification_header_paragraph,
\040\040\040\040editions.email_notification_footer_paragraph\040AS\040editions_email_notification_footer_paragraph,
\040\040\040\040editions.email_notification_sign_off\040AS\040editions_email_notification_sign_off,
\040\040\040\040editions.email_notification_sender_address\040AS\040editions_email_notification_sender_address,
\040\040\040\040editions.email_notification_sender_name\040AS\040editions_email_notification_sender_name,
\040\040\040\040editions.show_generic_journeys\040AS\040editions_show_generic_journeys,
\040\040\040\040editions.redirect_on_idle\040AS\040editions_redirect_on_idle,
\040\040\040\040editions.internal_name\040AS\040editions_internal_name,
\040\040\040\040editions.disable_attachments\040AS\040editions_disable_attachments,
\040\040\040\040editions.override_program_sort_order\040AS\040editions_override_program_sort_order,
\040\040\040\040editions.require_payment_by_default\040AS\040editions_require_payment_by_default,
\040\040\040\040editions.gtm_container_id\040AS\040editions_gtm_container_id,
\040\040\040\040editions.tracking_snippet\040AS\040editions_tracking_snippet,
\040\040\040\040editions.acronym\040AS\040editions_acronym,
\040\040\040\040editions.email_tracking_domain\040AS\040editions_email_tracking_domain,
\040\040\040\040editions.send_welcome_notification\040AS\040editions_send_welcome_notification,
\040\040\040\040editions.welcome_notification_content\040AS\040editions_welcome_notification_content,
\040\040\040\040editions.post_program_survey_id\040AS\040editions_post_program_survey_id,
\040\040\040\040editions.enabled\040AS\040editions_enabled,
\040\040\040\040editions.helpdesk_type\040AS\040editions_helpdesk_type,
\040\040\040\040editions.helpdesk_location\040AS\040editions_helpdesk_location,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id;
select\040*\040from\040\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id;
select\040*\040from\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id;
select\040anon_1.*\040from\040\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
;
select\040anon_1.*\040from\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id;
use\040nomadic;
select\040anon_1.*\040from\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT\040\040\040\040\040id\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id;
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040
FROM
\040\040\040\040editions
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040\040FROM\040\040\040\040\040editions\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
use\040nomadic;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040
FROM
\040\040\040\040editions
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040\040FROM\040\040\040\040\040editions\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT
\040\040\040\040id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count
FROM
\040\040\040\040editions
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT\040\040\040\040\040id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count\040FROM\040\040\040\040\040editions\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT
\040\040\040\040editions.id,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.count\040AS\040anon_4_count,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count
FROM
\040\040\040\040editions
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
SELECT\040\040\040\040\040editions.id,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.count\040AS\040anon_4_count,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count\040FROM\040\040\040\040\040editions\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-12-13'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040anon_4.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-11-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-09-20'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.edition_id\040=\040editions.id;
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id;
describe\040votes;
show\040tables;
describe\040resource_progress;
describe\040resource_view;
select\040user_id,\040count(*)\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040u.edition_id=71\040and\040group\040by\040user_id\040order\040by\040count(*);
select\040user_id,\040count(psu.user_id)\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040u.edition_id=71\040and\040group\040by\040user_id\040order\040by\040count(psu.user_id);
select\040user_id,\040count(psu.user_id)\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040u.edition_id=71\040and\040group\040by\040user_id;
select\040user_id,\040count(psu.user_id)\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040u.edition_id=71\040group\040by\040user_id;
select\040count,\040count(*)\040from\040(select\040user_id,\040count(psu.user_id)\040as\040'count'\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040u.edition_id=71\040group\040by\040user_id)\040t1\040group\040by\040count;
select\040count,\040count(*)\040from\040(select\040user_id,\040count(psu.user_id)\040as\040'count'\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040u.edition_id=71\040group\040by\040user_id)\040t1\040group\040by\040count\040order\040by\040count;
select\040count,\040count(*)\040from\040(select\040user_id,\040count(psu.user_id)\040as\040'count'\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040ps.start_date\040<\040utc_timestamp()\040and\040ps.end_date\040>\040utc_timestamp()\040and\040u.edition_id=71\040group\040by\040user_id)\040t1\040group\040by\040count\040order\040by\040count;
select\040user_id,\040count(psu.user_id)\040as\040'count'\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040where\040ps.start_date\040<\040utc_timestamp()\040and\040ps.end_date\040>\040utc_timestamp()\040and\040u.edition_id=71\040group\040by\040user_id;
describe\040group_set;
describe\040program_session;
select\040user_id,\040count(psu.user_id)\040as\040'count'\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040inner\040join\040group_set\040gs\040on\040ps.group_set_id=gs.id\040inner\040join\040groups\040g\040on\040g.group_set_id=gs.id\040inner\040join\040groupusers\040gu\040on\040gu.user_id=u.id\040and\040gu.group_id=g.id\040where\040g.start_date\040<\040utc_timestamp()\040and\040g.end_date\040>\040utc_timestamp()\040and\040u.edition_id=71\040group\040by\040user_id;
describe\040groups;
describe\040group;
describe\040groups;
show\040tables;
describe\040groups;
describe\040vprogs;
describe\040groups;
describe\040`groups`;
select\040user_id,\040count(psu.user_id)\040as\040'count'\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040inner\040join\040group_set\040gs\040on\040ps.group_set_id=gs.id\040inner\040join\040`groups`\040g\040on\040g.group_set_id=gs.id\040inner\040join\040groupusers\040gu\040on\040gu.user_id=u.id\040and\040gu.group_id=g.id\040where\040g.start_date\040<\040utc_timestamp()\040and\040g.end_date\040>\040utc_timestamp()\040and\040u.edition_id=71\040group\040by\040user_id;
select\040psu.user_id,\040count(psu.user_id)\040as\040'count'\040from\040program_session_user\040psu\040inner\040join\040users\040u\040on\040u.id=psu.user_id\040inner\040join\040program_session\040ps\040on\040ps.id=psu.session_id\040inner\040join\040group_set\040gs\040on\040ps.group_set_id=gs.id\040inner\040join\040`groups`\040g\040on\040g.group_set_id=gs.id\040inner\040join\040groupusers\040gu\040on\040gu.user_id=u.id\040and\040gu.group_id=g.id\040where\040g.start_date\040<\040utc_timestamp()\040and\040g.end_date\040>\040utc_timestamp()\040and\040u.edition_id=71\040group\040by\040user_id;
select\040*\040from\040groupusers\040gu\040inner\040join\040groups\040g\040on\040g.id=gu.group_id\040inner\040join\040users\040u\040on\040gu.user_id=u.id;
select\040*\040from\040groupusers\040gu\040inner\040join\040`groups`\040g\040on\040g.id=gu.group_id\040inner\040join\040users\040u\040on\040gu.user_id=u.id;
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com';
use\040nomadic;
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com';
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com'\134G
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com'\040and\040edition_id=71\040\134G
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com'\040and\040edition_id=51\040\134G
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com'\040and\040edition_id=52\040\134G
select\040*\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040where\040l.email='james@nomadiclearning.com'\040and\040edition_id=71\040\134G
select\040*\040from\040progress_push_event_edition_filter;
use\040nomadic;
select\040*\040from\040progress_push_event_edition_filter;
describe\040progress_push_event_edition_filter;
insert\040into\040progress_push_event_edition_filter(destination,\040edition_id)\040values('custify',\04071);
select\040*\040from\040progress_push_event;
use\040nomadic;
select\040*\040from\040progress_push_event;
select\040count(*)\040from\040progress_push_event;
insert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100)
;
use\040nomadic;
insert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100)
;
select\040*\040from\040program_completion_log\040where\040id=last_insert_id();
use\040nomadic;
select\040*\040from\040program_completion_log\040where\040id=last_insert_id();
select\040*\040from\040program_completion_log\040where\040user_id=180345;
begin;
update\040program_completion_log\040set\040posted=utc_timestamp()\040where\040id=6720588;
commit;
select\040*\040from\040progress_push_event;
use\040nomadic;
select\040*\040from\040progress_push_event;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\04010;
update\040progress_push_event\040set\040sent=NULL\040where\040id=2165;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0401;
update\040progress_push_event\040set\040sent=NULL\040where\040id=2165;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0401;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0405;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0401;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0405;
update\040progress_push_event\040set\040sent=NULL\040where\040id=2165;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0405;
update\040progress_push_event\040set\040sent=NULL\040where\040id=2165;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0405;
update\040progress_push_event\040set\040sent=NULL\040where\040id=2165;
select\040*\040from\040progress_push_event\040order\040by\040created\040desc\040limit\0405;
update\040progress_push_event\040set\040sent=NULL\040where\040id=2165;
update\040progress_push_event\040set\040sent=NULL\040where\040id=216;5
;
EXPLAIN
SELECT
\040\040\040\040editions.language_codes\040AS\040editions_language_codes,
\040\040\040\040editions.id\040AS\040editions_id,
\040\040\040\040editions.name\040AS\040editions_name,
\040\040\040\040editions.brand_id\040AS\040editions_brand_id,
\040\040\040\040editions.created\040AS\040editions_created,
\040\040\040\040editions.starts\040AS\040editions_starts,
\040\040\040\040editions.expires\040AS\040editions_expires,
\040\040\040\040editions.intro_title\040AS\040editions_intro_title,
\040\040\040\040editions.header_title\040AS\040editions_header_title,
\040\040\040\040editions.intro_menu_title\040AS\040editions_intro_menu_title,
\040\040\040\040editions.introduction\040AS\040editions_introduction,
\040\040\040\040editions.introduction_admin\040AS\040editions_introduction_admin,
\040\040\040\040editions.use_cohorts\040AS\040editions_use_cohorts,
\040\040\040\040editions.enable_payment\040AS\040editions_enable_payment,
\040\040\040\040editions.send_registration_notifications\040AS\040editions_send_registration_notifications,
\040\040\040\040editions.header_logo\040AS\040editions_header_logo,
\040\040\040\040editions.intro_logo\040AS\040editions_intro_logo,
\040\040\040\040editions.intro_video_placeholder\040AS\040editions_intro_video_placeholder,
\040\040\040\040editions.intro_video_ref\040AS\040editions_intro_video_ref,
\040\040\040\040editions.intro_video_id\040AS\040editions_intro_video_id,
\040\040\040\040editions.enable_resource_library\040AS\040editions_enable_resource_library,
\040\040\040\040editions.resources_admin_only\040AS\040editions_resources_admin_only,
\040\040\040\040editions.enable_program_wide_conversations\040AS\040editions_enable_program_wide_conversations,
\040\040\040\040editions.profile_disclaimer\040AS\040editions_profile_disclaimer,
\040\040\040\040editions.lock_user_name\040AS\040editions_lock_user_name,
\040\040\040\040editions.show_email_in_profile\040AS\040editions_show_email_in_profile,
\040\040\040\040editions.show_profile_dialog\040AS\040editions_show_profile_dialog,
\040\040\040\040editions.enable_comment_moderation\040AS\040editions_enable_comment_moderation,
\040\040\040\040editions.disable_comment_links\040AS\040editions_disable_comment_links,
\040\040\040\040editions.timezone\040AS\040editions_timezone,
\040\040\040\040editions.licenses\040AS\040editions_licenses,
\040\040\040\040editions.skip_edition_welcome\040AS\040editions_skip_edition_welcome,
\040\040\040\040editions.dark_text\040AS\040editions_dark_text,
\040\040\040\040editions.about_content\040AS\040editions_about_content,
\040\040\040\040editions.custom_css\040AS\040editions_custom_css,
\040\040\040\040editions.privacy_notice\040AS\040editions_privacy_notice,
\040\040\040\040editions.send_mass_conversation_notifications\040AS\040editions_send_mass_conversation_notifications,
\040\040\040\040editions.enable_document_library\040AS\040editions_enable_document_library,
\040\040\040\040editions.video_source\040AS\040editions_video_source,
\040\040\040\040editions.must_comment_in_all_debates\040AS\040editions_must_comment_in_all_debates,
\040\040\040\040editions.yourlearning_id\040AS\040editions_yourlearning_id,
\040\040\040\040editions.mixed\040AS\040editions_mixed,
\040\040\040\040editions.enable_community\040AS\040editions_enable_community,
\040\040\040\040editions.community_edition_id\040AS\040editions_community_edition_id,
\040\040\040\040editions.community_terms_popup\040AS\040editions_community_terms_popup,
\040\040\040\040editions.community_terms_page\040AS\040editions_community_terms_page,
\040\040\040\040editions.community_expert_flair\040AS\040editions_community_expert_flair,
\040\040\040\040editions.community_expert_label\040AS\040editions_community_expert_label,
\040\040\040\040editions.guide_video_id\040AS\040editions_guide_video_id,
\040\040\040\040editions.email_header_image\040AS\040editions_email_header_image,
\040\040\040\040editions.always_allow_resources\040AS\040editions_always_allow_resources,
\040\040\040\040editions.enable_open_registration\040AS\040editions_enable_open_registration,
\040\040\040\040editions.enable_invite_links\040AS\040editions_enable_invite_links,
\040\040\040\040editions.stripe_secret_key\040AS\040editions_stripe_secret_key,
\040\040\040\040editions.stripe_publishable_key\040AS\040editions_stripe_publishable_key,
\040\040\040\040editions.enable_channels\040AS\040editions_enable_channels,
\040\040\040\040editions.enable_create_channels\040AS\040editions_enable_create_channels,
\040\040\040\040editions.enable_public_channels\040AS\040editions_enable_public_channels,
\040\040\040\040editions.community_share_message\040AS\040editions_community_share_message,
\040\040\040\040editions.email_notification_header_paragraph\040AS\040editions_email_notification_header_paragraph,
\040\040\040\040editions.email_notification_footer_paragraph\040AS\040editions_email_notification_footer_paragraph,
\040\040\040\040editions.email_notification_sign_off\040AS\040editions_email_notification_sign_off,
\040\040\040\040editions.email_notification_sender_address\040AS\040editions_email_notification_sender_address,
\040\040\040\040editions.email_notification_sender_name\040AS\040editions_email_notification_sender_name,
\040\040\040\040editions.show_generic_journeys\040AS\040editions_show_generic_journeys,
\040\040\040\040editions.redirect_on_idle\040AS\040editions_redirect_on_idle,
\040\040\040\040editions.internal_name\040AS\040editions_internal_name,
\040\040\040\040editions.disable_attachments\040AS\040editions_disable_attachments,
\040\040\040\040editions.override_program_sort_order\040AS\040editions_override_program_sort_order,
\040\040\040\040editions.require_payment_by_default\040AS\040editions_require_payment_by_default,
\040\040\040\040editions.gtm_container_id\040AS\040editions_gtm_container_id,
\040\040\040\040editions.tracking_snippet\040AS\040editions_tracking_snippet,
\040\040\040\040editions.acronym\040AS\040editions_acronym,
\040\040\040\040editions.email_tracking_domain\040AS\040editions_email_tracking_domain,
\040\040\040\040editions.send_welcome_notification\040AS\040editions_send_welcome_notification,
\040\040\040\040editions.welcome_notification_content\040AS\040editions_welcome_notification_content,
\040\040\040\040editions.post_program_survey_id\040AS\040editions_post_program_survey_id,
\040\040\040\040editions.enabled\040AS\040editions_enabled,
\040\040\040\040editions.helpdesk_type\040AS\040editions_helpdesk_type,
\040\040\040\040editions.helpdesk_location\040AS\040editions_helpdesk_location,
\040\040\040\040editions.custify_last_run\040AS\040editions_custify_last_run,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_2
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_3
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040editions.language_codes\040AS\040editions_language_codes,
\040\040\040\040editions.id\040AS\040editions_id,
\040\040\040\040editions.name\040AS\040editions_name,
\040\040\040\040editions.brand_id\040AS\040editions_brand_id,
\040\040\040\040editions.created\040AS\040editions_created,
\040\040\040\040editions.starts\040AS\040editions_starts,
\040\040\040\040editions.expires\040AS\040editions_expires,
\040\040\040\040editions.intro_title\040AS\040editions_intro_title,
\040\040\040\040editions.header_title\040AS\040editions_header_title,
\040\040\040\040editions.intro_menu_title\040AS\040editions_intro_menu_title,
\040\040\040\040editions.introduction\040AS\040editions_introduction,
\040\040\040\040editions.introduction_admin\040AS\040editions_introduction_admin,
\040\040\040\040editions.use_cohorts\040AS\040editions_use_cohorts,
\040\040\040\040editions.enable_payment\040AS\040editions_enable_payment,
\040\040\040\040editions.send_registration_notifications\040AS\040editions_send_registration_notifications,
\040\040\040\040editions.header_logo\040AS\040editions_header_logo,
\040\040\040\040editions.intro_logo\040AS\040editions_intro_logo,
\040\040\040\040editions.intro_video_placeholder\040AS\040editions_intro_video_placeholder,
\040\040\040\040editions.intro_video_ref\040AS\040editions_intro_video_ref,
\040\040\040\040editions.intro_video_id\040AS\040editions_intro_video_id,
\040\040\040\040editions.enable_resource_library\040AS\040editions_enable_resource_library,
\040\040\040\040editions.resources_admin_only\040AS\040editions_resources_admin_only,
\040\040\040\040editions.enable_program_wide_conversations\040AS\040editions_enable_program_wide_conversations,
\040\040\040\040editions.profile_disclaimer\040AS\040editions_profile_disclaimer,
\040\040\040\040editions.lock_user_name\040AS\040editions_lock_user_name,
\040\040\040\040editions.show_email_in_profile\040AS\040editions_show_email_in_profile,
\040\040\040\040editions.show_profile_dialog\040AS\040editions_show_profile_dialog,
\040\040\040\040editions.enable_comment_moderation\040AS\040editions_enable_comment_moderation,
\040\040\040\040editions.disable_comment_links\040AS\040editions_disable_comment_links,
\040\040\040\040editions.timezone\040AS\040editions_timezone,
\040\040\040\040editions.licenses\040AS\040editions_licenses,
\040\040\040\040editions.skip_edition_welcome\040AS\040editions_skip_edition_welcome,
\040\040\040\040editions.dark_text\040AS\040editions_dark_text,
\040\040\040\040editions.about_content\040AS\040editions_about_content,
\040\040\040\040editions.custom_css\040AS\040editions_custom_css,
\040\040\040\040editions.privacy_notice\040AS\040editions_privacy_notice,
\040\040\040\040editions.send_mass_conversation_notifications\040AS\040editions_send_mass_conversation_notifications,
\040\040\040\040editions.enable_document_library\040AS\040editions_enable_document_library,
\040\040\040\040editions.video_source\040AS\040editions_video_source,
\040\040\040\040editions.must_comment_in_all_debates\040AS\040editions_must_comment_in_all_debates,
\040\040\040\040editions.yourlearning_id\040AS\040editions_yourlearning_id,
\040\040\040\040editions.mixed\040AS\040editions_mixed,
\040\040\040\040editions.enable_community\040AS\040editions_enable_community,
\040\040\040\040editions.community_edition_id\040AS\040editions_community_edition_id,
\040\040\040\040editions.community_terms_popup\040AS\040editions_community_terms_popup,
\040\040\040\040editions.community_terms_page\040AS\040editions_community_terms_page,
\040\040\040\040editions.community_expert_flair\040AS\040editions_community_expert_flair,
\040\040\040\040editions.community_expert_label\040AS\040editions_community_expert_label,
\040\040\040\040editions.guide_video_id\040AS\040editions_guide_video_id,
\040\040\040\040editions.email_header_image\040AS\040editions_email_header_image,
\040\040\040\040editions.always_allow_resources\040AS\040editions_always_allow_resources,
\040\040\040\040editions.enable_open_registration\040AS\040editions_enable_open_registration,
\040\040\040\040editions.enable_invite_links\040AS\040editions_enable_invite_links,
\040\040\040\040editions.stripe_secret_key\040AS\040editions_stripe_secret_key,
\040\040\040\040editions.stripe_publishable_key\040AS\040editions_stripe_publishable_key,
\040\040\040\040editions.enable_channels\040AS\040editions_enable_channels,
\040\040\040\040editions.enable_create_channels\040AS\040editions_enable_create_channels,
\040\040\040\040editions.enable_public_channels\040AS\040editions_enable_public_channels,
\040\040\040\040editions.community_share_message\040AS\040editions_community_share_message,
\040\040\040\040editions.email_notification_header_paragraph\040AS\040editions_email_notification_header_paragraph,
\040\040\040\040editions.email_notification_footer_paragraph\040AS\040editions_email_notification_footer_paragraph,
\040\040\040\040editions.email_notification_sign_off\040AS\040editions_email_notification_sign_off,
\040\040\040\040editions.email_notification_sender_address\040AS\040editions_email_notification_sender_address,
\040\040\040\040editions.email_notification_sender_name\040AS\040editions_email_notification_sender_name,
\040\040\040\040editions.show_generic_journeys\040AS\040editions_show_generic_journeys,
\040\040\040\040editions.redirect_on_idle\040AS\040editions_redirect_on_idle,
\040\040\040\040editions.internal_name\040AS\040editions_internal_name,
\040\040\040\040editions.disable_attachments\040AS\040editions_disable_attachments,
\040\040\040\040editions.override_program_sort_order\040AS\040editions_override_program_sort_order,
\040\040\040\040editions.require_payment_by_default\040AS\040editions_require_payment_by_default,
\040\040\040\040editions.gtm_container_id\040AS\040editions_gtm_container_id,
\040\040\040\040editions.tracking_snippet\040AS\040editions_tracking_snippet,
\040\040\040\040editions.acronym\040AS\040editions_acronym,
\040\040\040\040editions.email_tracking_domain\040AS\040editions_email_tracking_domain,
\040\040\040\040editions.send_welcome_notification\040AS\040editions_send_welcome_notification,
\040\040\040\040editions.welcome_notification_content\040AS\040editions_welcome_notification_content,
\040\040\040\040editions.post_program_survey_id\040AS\040editions_post_program_survey_id,
\040\040\040\040editions.enabled\040AS\040editions_enabled,
\040\040\040\040editions.helpdesk_type\040AS\040editions_helpdesk_type,
\040\040\040\040editions.helpdesk_location\040AS\040editions_helpdesk_location,
\040\040\040\040editions.custify_last_run\040AS\040editions_custify_last_run,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_2
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_3
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
EXPLAIN
SELECT
\040\040\040\040editions.*
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_2
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_3
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
EXPLAIN\040SELECT\040\040\040\040\040editions.*\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.time\040AS\040anon_4_time,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count,\040\040\040\040\040anon_7.count\040AS\040anon_7_count,\040\040\040\040\040anon_8.count\040AS\040anon_8_count,\040\040\040\040\040anon_9.count\040AS\040anon_9_count,\040\040\040\040\040anon_10.count\040AS\040anon_10_count,\040\040\040\040\040anon_11.count\040AS\040anon_11_count,\040\040\040\040\040anon_12.count\040AS\040anon_12_count,\040\040\040\040\040anon_13.count\040AS\040anon_13_count,\040\040\040\040\040anon_14.count\040AS\040anon_14_count,\040\040\040\040\040anon_15.count\040AS\040anon_15_count,\040\040\040\040\040anon_16.count\040AS\040anon_16_count,\040\040\040\040\040anon_17.count\040AS\040anon_17_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_2\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_3\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
EXPLAIN
SELECT
\040\040\040\040editions.*,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_2
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_3
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
EXPLAIN\040SELECT\040\040\040\040\040editions.*,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.time\040AS\040anon_4_time,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count,\040\040\040\040\040anon_7.count\040AS\040anon_7_count,\040\040\040\040\040anon_8.count\040AS\040anon_8_count,\040\040\040\040\040anon_9.count\040AS\040anon_9_count,\040\040\040\040\040anon_10.count\040AS\040anon_10_count,\040\040\040\040\040anon_11.count\040AS\040anon_11_count,\040\040\040\040\040anon_12.count\040AS\040anon_12_count,\040\040\040\040\040anon_13.count\040AS\040anon_13_count,\040\040\040\040\040anon_14.count\040AS\040anon_14_count,\040\040\040\040\040anon_15.count\040AS\040anon_15_count,\040\040\040\040\040anon_16.count\040AS\040anon_16_count,\040\040\040\040\040anon_17.count\040AS\040anon_17_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_2\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040:dt_3\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
EXPLAIN
SELECT
\040\040\040\040editions.*,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
EXPLAIN\040SELECT\040\040\040\040\040editions.*,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.time\040AS\040anon_4_time,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count,\040\040\040\040\040anon_7.count\040AS\040anon_7_count,\040\040\040\040\040anon_8.count\040AS\040anon_8_count,\040\040\040\040\040anon_9.count\040AS\040anon_9_count,\040\040\040\040\040anon_10.count\040AS\040anon_10_count,\040\040\040\040\040anon_11.count\040AS\040anon_11_count,\040\040\040\040\040anon_12.count\040AS\040anon_12_count,\040\040\040\040\040anon_13.count\040AS\040anon_13_count,\040\040\040\040\040anon_14.count\040AS\040anon_14_count,\040\040\040\040\040anon_15.count\040AS\040anon_15_count,\040\040\040\040\040anon_16.count\040AS\040anon_16_count,\040\040\040\040\040anon_17.count\040AS\040anon_17_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
use\040nomadic;
EXPLAIN
SELECT
\040\040\040\040editions.*,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
EXPLAIN\040SELECT\040\040\040\040\040editions.*,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.time\040AS\040anon_4_time,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count,\040\040\040\040\040anon_7.count\040AS\040anon_7_count,\040\040\040\040\040anon_8.count\040AS\040anon_8_count,\040\040\040\040\040anon_9.count\040AS\040anon_9_count,\040\040\040\040\040anon_10.count\040AS\040anon_10_count,\040\040\040\040\040anon_11.count\040AS\040anon_11_count,\040\040\040\040\040anon_12.count\040AS\040anon_12_count,\040\040\040\040\040anon_13.count\040AS\040anon_13_count,\040\040\040\040\040anon_14.count\040AS\040anon_14_count,\040\040\040\040\040anon_15.count\040AS\040anon_15_count,\040\040\040\040\040anon_16.count\040AS\040anon_16_count,\040\040\040\040\040anon_17.count\040AS\040anon_17_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040editions.*,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id;
SELECT\040\040\040\040\040editions.*,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id;
SELECT
\040\040\040\040editions.*,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id;
SELECT\040\040\040\040\040editions.*,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id;
SELECT
\040\040\040\040count(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id;
SELECT\040\040\040\040\040count(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id;
SELECT
\040\040\040\040count(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id;
SELECT\040\040\040\040\040count(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id;
SELECT
\040\040\040\040count(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id;
SELECT\040\040\040\040\040count(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id;
SELECT
\040\040\040\040count(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040WHERE\040edition_id=71;
SELECT\040\040\040\040\040count(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040WHERE\040edition_id=71;
SELECT
\040\040\040\040count(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040WHERE\040anon_1.edition_id=71;
SELECT\040\040\040\040\040count(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040WHERE\040anon_1.edition_id=71;
SELECT
\040\040\040\040count(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040WHERE\040anon_1.edition_id=71;
SELECT\040\040\040\040\040count(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040WHERE\040anon_1.edition_id=71;
SELECT
\040\040\040\040count(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040WHERE\040anon_1.edition_id=71;
SELECT\040\040\040\040\040count(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040WHERE\040anon_1.edition_id=71;
SELECT
\040\040\040\040editions.*,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT\040\040\040\040\040editions.*,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.time\040AS\040anon_4_time,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count,\040\040\040\040\040anon_7.count\040AS\040anon_7_count,\040\040\040\040\040anon_8.count\040AS\040anon_8_count,\040\040\040\040\040anon_9.count\040AS\040anon_9_count,\040\040\040\040\040anon_10.count\040AS\040anon_10_count,\040\040\040\040\040anon_11.count\040AS\040anon_11_count,\040\040\040\040\040anon_12.count\040AS\040anon_12_count,\040\040\040\040\040anon_13.count\040AS\040anon_13_count,\040\040\040\040\040anon_14.count\040AS\040anon_14_count,\040\040\040\040\040anon_15.count\040AS\040anon_15_count,\040\040\040\040\040anon_16.count\040AS\040anon_16_count,\040\040\040\040\040anon_17.count\040AS\040anon_17_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040editions.*,
\040\040\040\040anon_1.latest\040AS\040anon_1_latest,
\040\040\040\040anon_2.count\040AS\040anon_2_count,
\040\040\040\040anon_3.count\040AS\040anon_3_count,
\040\040\040\040anon_4.time\040AS\040anon_4_time,
\040\040\040\040anon_5.count\040AS\040anon_5_count,
\040\040\040\040anon_6.count\040AS\040anon_6_count,
\040\040\040\040anon_7.count\040AS\040anon_7_count,
\040\040\040\040anon_8.count\040AS\040anon_8_count,
\040\040\040\040anon_9.count\040AS\040anon_9_count,
\040\040\040\040anon_10.count\040AS\040anon_10_count,
\040\040\040\040anon_11.count\040AS\040anon_11_count,
\040\040\040\040anon_12.count\040AS\040anon_12_count,
\040\040\040\040anon_13.count\040AS\040anon_13_count,
\040\040\040\040anon_14.count\040AS\040anon_14_count,
\040\040\040\040anon_15.count\040AS\040anon_15_count,
\040\040\040\040anon_16.count\040AS\040anon_16_count,
\040\040\040\040anon_17.count\040AS\040anon_17_count
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT\040\040\040\040\040editions.*,\040\040\040\040\040anon_1.latest\040AS\040anon_1_latest,\040\040\040\040\040anon_2.count\040AS\040anon_2_count,\040\040\040\040\040anon_3.count\040AS\040anon_3_count,\040\040\040\040\040anon_4.time\040AS\040anon_4_time,\040\040\040\040\040anon_5.count\040AS\040anon_5_count,\040\040\040\040\040anon_6.count\040AS\040anon_6_count,\040\040\040\040\040anon_7.count\040AS\040anon_7_count,\040\040\040\040\040anon_8.count\040AS\040anon_8_count,\040\040\040\040\040anon_9.count\040AS\040anon_9_count,\040\040\040\040\040anon_10.count\040AS\040anon_10_count,\040\040\040\040\040anon_11.count\040AS\040anon_11_count,\040\040\040\040\040anon_12.count\040AS\040anon_12_count,\040\040\040\040\040anon_13.count\040AS\040anon_13_count,\040\040\040\040\040anon_14.count\040AS\040anon_14_count,\040\040\040\040\040anon_15.count\040AS\040anon_15_count,\040\040\040\040\040anon_16.count\040AS\040anon_16_count,\040\040\040\040\040anon_17.count\040AS\040anon_17_count\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040COUNT(*)
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT\040\040\040\040\040COUNT(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040COUNT(*)
FROM
\040\040\040\040editions
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040OUTER\040JOIN\040\134(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT\040\040\040\040\040COUNT(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040OUTER\040JOIN\040\134(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040COUNT(*)
FROM
\040\040\040\040editions
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT\040\040\040\040\040COUNT(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040COUNT(*)
FROM
\040\040\040\040editions
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT\040\040\040\040\040COUNT(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040COUNT(*)
FROM
\040\040\040\040editions
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040AND\040users.edition_id=71
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT\040\040\040\040\040COUNT(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040AND\040users.edition_id=71\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL;
SELECT
\040\040\040\040COUNT(*)
FROM
\040\040\040\040editions
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040editions
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'
\040\040\040\040\040\040\040\040
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040editions.id
\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id
WHERE
\040\040\040\040editions.brand_id\040IS\040NOT\040NULL
AND\040editions.id=71;
SELECT\040\040\040\040\040COUNT(*)\040FROM\040\040\040\040\040editions\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.edition_id\040=\040editions.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(registration.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040registration\040ON\040users.id\040=\040registration.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_2\040ON\040editions.id\040=\040anon_2.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040enrolment\040ON\040users.id\040=\040enrolment.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_3\040ON\040editions.id\040=\040anon_3.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040time\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040viewtimelog\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_4\040ON\040editions.id\040=\040anon_4.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_5\040ON\040editions.id\040=\040anon_5.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(comments.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040comments\040ON\040users.id\040=\040comments.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040comments.parent_id\040IS\040NOT\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_6\040ON\040editions.id\040=\040anon_6.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(mention.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040mention\040ON\040users.id\040=\040mention.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_7\040ON\040editions.id\040=\040anon_7.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(commentvotes.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040commentvotes\040ON\040users.id\040=\040commentvotes.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_8\040ON\040editions.id\040=\040anon_8.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_view.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_view\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_9\040ON\040editions.id\040=\040anon_9.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(resource_progress.id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040resource_progress\040ON\040users.id\040=\040resource_progress.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_progress.completed\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_10\040ON\040editions.id\040=\040anon_10.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_11\040ON\040editions.id\040=\040anon_11.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040journey_user.completed\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_12\040ON\040editions.id\040=\040anon_12.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(journey_user.user_id))\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040journey_user\040ON\040users.id\040=\040journey_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_13\040ON\040editions.id\040=\040anon_13.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_14\040ON\040editions.id\040=\040anon_14.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_15\040ON\040editions.id\040=\040anon_15.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_16\040ON\040editions.id\040=\040anon_16.edition_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040AS\040edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(DISTINCT\040analytics_active_users.user_id)\040AS\040count\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040editions\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040analytics_active_users\040ON\040analytics_active_users.user_id\040=\040users.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.dt\040>\040'2021-01-01'\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040editions.id\040\040\040\040\040)\040AS\040anon_17\040ON\040editions.id\040=\040anon_17.edition_id\040WHERE\040\040\040\040\040editions.brand_id\040IS\040NOT\040NULL\040AND\040editions.id=71;
describe\040editions;
select\040edition_id,\040max(analytics_active_users.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040edition_id;
select\040u.edition_id,\040max(analytics_active_users.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id;
describe\040analytics_active_users;
use\040nomadic;
describe\040analytics_active_users;
select\040u.edition_id,\040max(analytics_active_users.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id;
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id;
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id\040order\040by\040max(aau.dt);
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id\040order\040by\040max(aau.dt)\040having\040aau.dt\040>\040'2021-03-10';
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id\040having\040aau.dt\040>\040'2021-03-10'\040order\040by\040max(aau.dt);
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id\040having\040max(aau.dt)\040>\040'2021-03-10'\040order\040by\040max(aau.dt);
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id\040having\040max(aau.dt)\040>\040'2021-03-9'\040order\040by\040max(aau.dt);
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id\040having\040max(aau.dt)\040>\040'2021-03-9\04020:00'\040order\040by\040max(aau.dt);
select\040u.edition_id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.edition_id\040having\040max(aau.dt)\040>\040'2021-03-9\04023:00'\040order\040by\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-9\04023:00';
update\040editions\040set\040custify_last_run=NULL;
update\040editions\040set\040custify_last_run='2021-03-9\04023:00';
UPDATE\040editions\040set\040custify_last_run=NULL\040where\040id=71;
update\040editions\040set\040custify_last_run='2021-03-9\04023:00';
select\040e.id,\040count(rp.resource_id)\040from\040edition\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040resource_progress\040rp\040on\040rp.user_id=u.id\040where\040u.edition_id=130;
select\040e.id,\040count(rp.resource_id)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040resource_progress\040rp\040on\040rp.user_id=u.id\040where\040u.edition_id=130;
select\040e.id,\040count(distinct\040rp.resource_id)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040resource_progress\040rp\040on\040rp.user_id=u.id\040where\040u.edition_id=130;
select\040e.id,\040count(distinct\040rp.resource_id)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040resource_progress\040rp\040on\040rp.user_id=u.id\040where\040u.edition_id=130\040group\040by\040e.id;
select\040e.id,\040count(rp.resource_id)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040resource_progress\040rp\040on\040rp.user_id=u.id\040where\040u.edition_id=130\040group\040by\040e.id;
select\040e.id,\040count(rp.id)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040resource_progress\040rp\040on\040rp.user_id=u.id\040where\040u.edition_id=130\040group\040by\040e.id;
select\040e.id,\040count(rp.id)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040resource_progress\040rp\040on\040rp.user_id=u.id\040where\040u.edition_id=130\040and\040rp.completed=1\040group\040by\040e.id;
describe\040resource_progress;
update\040editions\040set\040custify_last_run='2021-03-9\04023:00';
select\040u.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-9\04023:00'\040order\040by\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-9\04023:00';
select\040u.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-9\04023:00'\040order\040by\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-9\04023:00';
select\040u.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040max(aau.dt);
select\040u.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040where\040e.custify_last_run\040is\040not\040null\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-9\04023:00'\040where\040id=71;
select\040u.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040where\040e.custify_last_run\040is\040not\040null\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040max(aau.dt);
select\040u.id,\040e.id\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040where\040e.custify_last_run\040is\040not\040null\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040max(aau.dt);
select\040u.id,\040e.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040where\040e.custify_last_run\040is\040not\040null\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040max(aau.dt);
update\040editions\040set\040custify_last_run=null\040where\040id=71;
select\040u.id,\040e.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040where\040e.custify_last_run\040is\040not\040null\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-9\04023:00';
update\040editions\040set\040custify_last_run='2021-03-8\04023:00';
update\040editions\040set\040custify_last_run=null\040where\040id=71;
select\040u.id,\040e.id,\040max(aau.dt)\040from\040editions\040e\040inner\040join\040users\040u\040on\040u.edition_id=e.id\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id=u.id\040where\040e.custify_last_run\040is\040not\040null\040group\040by\040u.id\040having\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040max(aau.dt);
update\040editions\040set\040custify_last_run=null;
update\040editions\040set\040custify_last_run='2021-01-01'\040where\040id=71;
select\040subscription_plan;
show\040tables;
select\040subscription_plan;
select\040*\040from\040subscription_plan;
select\040*\040from\040subscription_plan\134G
select\040*\040from\040users\040u\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040ps.plan_id\040not\040in\040(2,\04019);
select\040u.id,\040ps.plan_id\040from\040users\040u\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040ps.plan_id\040not\040in\040(2,\04019);
select\040u.id,\040ps.plan_id\040from\040users\040u\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040ps.plan_id\040is\040null;
select\040*\040from\040subscription_plan\134G
select\040*\040from\040subscription_plan\040where\040name\040like\040'%professional%'\134G
select\040*\040from\040subscription_plan\134G
select
\040\040\040\040u.id,
\040\040\040\040e.id,
\040\040\040\040max(aau.dt)
from
\040\040\040\040editions\040e
\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id
\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id
where
\040\040\040\040e.custify_last_run\040is\040not\040null
and\040
\040\040\040\040ps.plan_id\040is\040null
\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016);
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040and\040\040\040\040\040\040ps.plan_id\040is\040null\040\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016);
group\040by
\040\040\040\040u.id
having
\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'
order\040by
\040\040\040\040max(aau.dt);
group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040\040\040\040\040max(aau.dt);
select
\040\040\040\040u.id,
\040\040\040\040e.id,
\040\040\040\040max(aau.dt)
from
\040\040\040\040editions\040e
\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id
\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id
where
\040\040\040\040e.custify_last_run\040is\040not\040null
and\040
\040\040\040\040ps.plan_id\040is\040null
\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016)
group\040by
\040\040\040\040u.id
having
\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'
order\040by
\040\040\040\040max(aau.dt);
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040and\040\040\040\040\040\040ps.plan_id\040is\040null\040\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016)\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040\040\040\040\040max(aau.dt);
select
\040\040\040\040u.id,
\040\040\040\040e.id,
\040\040\040\040max(aau.dt)
from
\040\040\040\040editions\040e
\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id
\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id
where
\040\040\040\040e.custify_last_run\040is\040not\040null
group\040by
\040\040\040\040u.id
having
\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'
order\040by
\040\040\040\040max(aau.dt);
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040\040\040\040\040max(aau.dt);
[Fupdate\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
update\040editions\040set\040custify_last_run=null\040where\040id!=71;
select\040id,\040custify_last_run\040from\040editions;
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8'\040order\040by\040\040\040\040\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
select
\040\040\040\040u.id,
\040\040\040\040e.id,
\040\040\040\040max(aau.dt)
from
\040\040\040\040editions\040e
\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id
\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id
\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id
where
\040\040\040\040e.custify_last_run\040is\040not\040null
and
\040\040\040\040ps.plan_id\040is\040null\040or\040ps.plan_id\040not\040in\040(1,16)
group\040by
\040\040\040\040u.id
having
\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'
order\040by
\040\040\040\040max(aau.dt);
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040and\040\040\040\040\040ps.plan_id\040is\040null\040or\040ps.plan_id\040not\040in\040(1,16)\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04023:00'\040order\040by\040\040\040\040\040max(aau.dt);
select\040id,\040custify_last_run\040where\040id\040in\040(71,127);
select\040id,\040custify_last_run\040from\040editions\040where\040id\040in\040(71,127);
select
\040\040\040\040u.id,
\040\040\040\040e.id,
\040\040\040\040max(aau.dt)
from
\040\040\040\040editions\040e
\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id
\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id
\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id
where
\040\040\040\040e.custify_last_run\040is\040not\040null
and
\040\040\040\040(ps.plan_id\040is\040null\040or\040ps.plan_id\040not\040in\040(1,16))
group\040by
\040\040\040\040u.id
having
\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04000:00'
order\040by
\040\040\040\040max(aau.dt);
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040and\040\040\040\040\040(ps.plan_id\040is\040null\040or\040ps.plan_id\040not\040in\040(1,16))\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04000:00'\040order\040by\040\040\040\040\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
SELECT
\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id
\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id
WHERE
\040\040\040\040anon_1.latest\040>\040'2021-03-8\04000:00'
\040\040\040\040AND\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016);
SELECT\040\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id\040WHERE\040\040\040\040\040anon_1.latest\040>\040'2021-03-8\04000:00'\040\040\040\040\040AND\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016);
select
\040\040\040\040u.id,
\040\040\040\040e.id,
\040\040\040\040max(aau.dt)
from
\040\040\040\040editions\040e
\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id
\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id
where
\040\040\040\040e.custify_last_run\040is\040not\040null
\040\040\040\040and\040(
\040\040\040\040\040\040\040\040ps.plan_id\040is\040null
\040\040\040\040\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016)
\040\040\040\040)
group\040by
\040\040\040\040u.id
having
\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04000:00'
order\040by
\040\040\040\040max(aau.dt);
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040\040\040\040\040and\040(\040\040\040\040\040\040\040\040\040ps.plan_id\040is\040null\040\040\040\040\040\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016)\040\040\040\040\040)\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04000:00'\040order\040by\040\040\040\040\040max(aau.dt);
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
SELECT
\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id
\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id
WHERE
\040\040\040\040anon_1.latest\040>\040editions.custify_last_run
\040\040\040\040AND\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016);
SELECT\040\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id\040WHERE\040\040\040\040\040anon_1.latest\040>\040editions.custify_last_run\040\040\040\040\040AND\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016);
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
SELECT\040\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id\040WHERE\040\040\040\040\040anon_1.latest\040>\040editions.custify_last_run\040\040\040\040\040AND\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016);
select
\040\040\040\040u.id,
\040\040\040\040e.id,
\040\040\040\040max(aau.dt)
from
\040\040\040\040editions\040e
\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id
\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id
\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id
where
\040\040\040\040e.custify_last_run\040is\040not\040null
\040\040\040\040and\040(
\040\040\040\040\040\040\040\040ps.plan_id\040is\040null
\040\040\040\040\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016)
\040\040\040\040)
group\040by
\040\040\040\040u.id
having
\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04000:00'
order\040by
\040\040\040\040max(aau.dt);
select\040\040\040\040\040u.id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040\040\040\040\040and\040(\040\040\040\040\040\040\040\040\040ps.plan_id\040is\040null\040\040\040\040\040\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016)\040\040\040\040\040)\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04000:00'\040order\040by\040\040\040\040\040max(aau.dt);
select\040distinct\040user_id\040from\040(select\040\040\040\040\040u.id\040as\040user_id,\040\040\040\040\040e.id,\040\040\040\040\040max(aau.dt)\040from\040\040\040\040\040editions\040e\040\040\040\040\040inner\040join\040users\040u\040on\040u.edition_id\040=\040e.id\040\040\040\040\040inner\040join\040analytics_active_users\040aau\040on\040aau.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id\040=\040u.id\040\040\040\040\040left\040outer\040join\040platform_subscription\040ps\040on\040ps.id\040=\040psi.subscription_id\040where\040\040\040\040\040e.custify_last_run\040is\040not\040null\040\040\040\040\040and\040(\040\040\040\040\040\040\040\040\040ps.plan_id\040is\040null\040\040\040\040\040\040\040\040\040or\040ps.plan_id\040not\040in\040(1,\04016)\040\040\040\040\040)\040group\040by\040\040\040\040\040u.id\040having\040\040\040\040\040max(aau.dt)\040>\040'2021-03-8\04000:00'\040order\040by\040\040\040\040\040max(aau.dt))\040t1\040;
SELECT
\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1
FROM
\040\040\040\040editions
\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id
\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id
WHERE
\040\040\040\040anon_1.latest\040>\040editions.custify_last_run
\040\040\040\040AND\040(
\040\040\040\040\040\040\040\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016)
\040\040\040\040\040\040\040\040or\040platform_subscription.plan_id\040is\040null);
SELECT\040\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id\040WHERE\040\040\040\040\040anon_1.latest\040>\040editions.custify_last_run\040\040\040\040\040AND\040(\040\040\040\040\040\040\040\040\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016)\040\040\040\040\040\040\040\040\040or\040platform_subscription.plan_id\040is\040null);
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
SELECT\040\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id\040WHERE\040\040\040\040\040anon_1.latest\040>\040editions.custify_last_run\040\040\040\040\040AND\040(\040\040\040\040\040\040\040\040\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016)\040\040\040\040\040\040\040\040\040or\040platform_subscription.plan_id\040is\040null);
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
SELECT\040\040\040\040\040distinct(anon_1.user_id)\040AS\040distinct_1\040FROM\040\040\040\040\040editions\040\040\040\040\040JOIN\040users\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(analytics_active_users.dt)\040AS\040latest\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040analytics_active_users.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040editions\040ON\040editions.id\040=\040users.edition_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\0401\040=\0401\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription_invitation\040ON\040users.id\040=\040platform_subscription_invitation.user_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040platform_subscription\040ON\040platform_subscription.id\040=\040platform_subscription_invitation.subscription_id\040WHERE\040\040\040\040\040anon_1.latest\040>\040editions.custify_last_run\040\040\040\040\040AND\040(\040\040\040\040\040\040\040\040\040platform_subscription.plan_id\040NOT\040IN\040(1,\04016)\040\040\040\040\040\040\040\040\040or\040platform_subscription.plan_id\040is\040null);
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
use\040nomadic;
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
use\040nomadic;
update\040editions\040set\040custify_last_run='2021-03-08'\040where\040id=71;
select\040id\040from\040platform_subscription\040where\040seats\040>\04020;
select\040user_id\040from\040platform_subscription_invitation\040where\040subscription_id=5378\040and\040is_admin=1;
select\040user_id\040from\040platform_subscription_invitation\040where\040subscription_id=5110\040and\040is_admin=1;
select\040user_id\040from\040platform_subscription_invitation\040where\040subscription_id=5482\040and\040is_admin=1;
describe\040resource_progress;
describe\040journey_progress;
describe\040journey_user;
select\040count(*)\040from\040journey_user\040ju\040inner\040join\040users\040u\040on\040u.id=ju.user_id\040where\040ju.completed=1\040and\040u.edition_id=71;
update\040editions\040set\040custify_last_run='2017-03-01'\040where\040id=71;
select\040count(*)\040from\040platform_subscription\040where\040edition_id=71;
select\040plan_id,\040count(*)\040from\040platform_subscription\040where\040edition_id=71\040group\040by\040plan_id;
update\040editions\040set\040custify_last_run='2017-03-01'\040where\040id=71;
select\040count(*)\040from\040users\040where\040custify_last_updated\040is\040not\040null;
update\040editions\040set\040custify_last_run='2017-03-01'\040where\040id=71;
update\040users\040set\040custify_last_updated=null\040where\040edition_id=71;
select\040count(*)\040from\040users\040where\040custify_last_updated\040is\040not\040null;
select\040plan_id,\040count(*)\040from\040platform_subscription\040where\040edition_id=71\040group\040by\040plan_id;
update\040editions\040set\040custify_last_run='2017-03-01'\040where\040id=71;
select\040count(*)\040from\040users\040where\040custify_last_updated\040is\040not\040null;
update\040users\040set\040custify_last_updated=null;
update\040editions\040set\040custify_last_run='2017-03-01'\040where\040id=71;
select\040user_id\040from\040platform_subscription_invitation\040where\040subscription_id=5407\040and\040is_admin=1;
update\040editions\040set\040custify_last_run='2017-03-01'\040where\040id=71;
update\040users\040set\040custify_last_updated=null;
select\040*\040from\040subscription_plan;
use\040nomadic
select\040*\040from\040subscription_plan;
select\040*\040from\040subscription_plan\134G
begin;
select\040plan_id,\040count(*)\040from\040platform_subscription\040group\040by\040plan_id;
select\040plan_id,\040count(*)\040from\040platform_subscription\040where\040edition_id=71\040group\040by\040plan_id;
update\040subscription_plan\040set\040ignore_custify=1\040where\040id\040in\040(1,2,3,5);
describe\040subscription_plan;
update\040subscription_plan\040set\040custify_ignore=1\040where\040id\040in\040(1,2,3,5);
commit;
begin;
update\040editions\040set\040custify_last_run='2015-01-01'\040where\040id=71;
commit;
update\040editions\040set\040custify_last_run='2015-01-01'\040where\040id=71;
update\040subscription_plan\040set\040custify_ignore=0\040where\040id=2;
select\040*\040from\040progress_push_send;
use\040nomadic;
select\040*\040from\040progress_push_send;
select\040*\040from\040progress_push_event;
begin;
update\040program_sessions\040set\040sent=utc_timestamp()\040where\040sent\040is\040null;
update\040program_session\040set\040sent=utc_timestamp()\040where\040sent\040is\040null;
describe\040program_session;
update\040program_push_event;\040set\040sent=utc_timestamp()\040where\040sent\040is\040null;
describe\040progress_push_event;
update\040progress_push_event\040set\040`sent`=utc_timestamp()\040where\040`sent`\040is\040null;
commit;
select\040*\040from\040progress_push_event;
use\040nomadic;
select\040*\040from\040progress_push_event;
select\040*\040from\040progress_push_event_edition_filter;
select\040*\040from\040progress_push_event;
delete\040from\040progress_push_event\040where\040`sent`\040is\040null;
select\040*\040from\040progress_push_event;
select\040*\040from\040resource\040where\040ref='tech-powered-feedback';
use\040nomadic;
select\040*\040from\040resource\040where\040ref='tech-powered-feedback';
select\040*\040from\040resource\040where\040ref='tech-powered-feedback'\134G
begin;
update\040resource\040set\040quiz_count=1\040where\040ref='tech-powered-feedback';
commit;
select\040*\040from\040resource\040where\040ref='tech-powered-feedback'\134G
use\040nomadic;
select\040*\040from\040resource\040where\040ref='tech-powered-feedback'\134G
update\040resource\040set\040discussion_count=1\040where\040ref='tech-powered-feedback';
select\040id,\040language,\040active\040from\040resource_version\040rv\040where\040ref='tech-powered-feedback';
update\040resource_version\040set\040active=1\040where\040id=7333;
select\040*\040from\040progress_push_events\040where\040`sent`\040is\040not\040null;
use\040nomadic;
select\040*\040from\040progress_push_events\040where\040`sent`\040is\040not\040null;
select\040*\040from\040progress_push_event\040where\040`sent`\040is\040not\040null;
use\040nomadic;
select\040*\040from\040progress_push_event\040where\040`sent`\040is\040not\040null;
select\040*\040from\040progress_push_event\040where\040`sent`\040is\040null;
update\040progress_push_event\040set\040sent=null\040where\040id>2175;
use\040nomadic;
update\040progress_push_event\040set\040sent=null\040where\040id>2175;
select\040*\040from\040progress_push_event\040where\040`sent`\040is\040null;
update\040progress_push_event\040set\040sent=null\040where\040id>2178;
select\040*\040from\040progress_push_event\040where\040`sent`\040is\040null;
update\040progress_push_event\040set\040sent=null\040where\040id>2183;
select\040*\040from\040progress_push_event\040where\040`sent`\040is\040null;
select\040count(*)\040from\040enrolment;
describe\040enrolment;
describe\040comments;
select\040*\040from\040progress_push_events;
select\040*\040from\040progress_push_event;
select\040*\040from\040progress_push_event\040where\040action='create';
select\040*\040from\040progress_push_event\040where\040action='create'\040and\040activity_type='comment';
select\040*\040from\040progress_push_event\040where\040action='create'\040and\040activity_type='comment'\040limit\04010;
select\040activity_id,\040count(*)\040from\040progress_push_event\040where\040action='create'\040and\040activity_type='comment'\040group\040by\040activity_id\040order\040by\040count(*);
select\040activity_id,\040count(*)\040from\040progress_push_event\040where\040action='create'\040and\040activity_type='comment'\040group\040by\040activity_id\040order\040by\040count(*)\040desc;
select\040activity_id,\040count(*)\040from\040progress_push_event\040where\040action='create'\040and\040activity_type='comment'\040group\040by\040activity_id\040order\040by\040count(*)\040asc;
select\040ppe.*\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040where\040action='create'\040and\040activity_type='comment';
select\040ppe.*\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040and\040ppe.activity_id=c.id\040where\040action='create'\040and\040activity_type='comment';
select\040psi.subscription_id\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040and\040ppe.activity_id=c.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040action='create'\040and\040activity_type='comment';
select\040psi.subscription_id,\040count(*)\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040and\040ppe.activity_id=c.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040action='create'\040and\040activity_type='comment'\040group\040by\040psi.subscription_id;
begin;
delete\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040and\040ppe.activity_id=c.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040action='create'\040and\040activity_type='comment'\040and\040psi.subscription_id=5060;
select\040psi.subscription_id,\040count(*)\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040and\040ppe.activity_id=c.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040action='create'\040and\040activity_type='comment'\040group\040by\040psi.subscription_id;
select\040psi.subscription_id,\040count(*)\040from\040users\040u\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040group\040by\040psi.subscription_id;
select\040psi.subscription_id,\040count(*)\040from\040users\040u\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040group\040by\040psi.subscription_id;
select\040psi.subscription_id,\040count(*)\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040and\040ppe.activity_id=c.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040action='create'\040and\040activity_type='comment'\040group\040by\040psi.subscription_id;
select\040psi.subscription_id,\040count(*)\040from\040users\040u\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040psi.subscription_id\040in\040(3912,\0403878,\0402950,\0405412,\0405060)\040group\040by\040psi.subscription_id;
select\040psi.subscription_id,\040count(*)\040from\040users\040u\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040inner\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040psi.subscription_id\040in\040(3912,\0403878,\0402950,\0405412,\0405060)\040group\040by\040psi.subscription_id;
select\040ps.name,\040psi.subscription_id,\040count(*)\040from\040users\040u\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040inner\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040psi.subscription_id\040in\040(3912,\0403878,\0402950,\0405412,\0405060)\040group\040by\040psi.subscription_id;
select\040psi.subscription_id,\040count(*)\040from\040users\040u\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040inner\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040psi.subscription_id\040in\040(3912,\0403878,\0402950,\0405412,\0405060)\040group\040by\040psi.subscription_id;
select\040ps.name,\040psi.subscription_id,\040count(*)\040from\040users\040u\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040inner\040join\040platform_subscription\040ps\040on\040ps.id=psi.subscription_id\040where\040psi.subscription_id\040in\040(3912,\0403878,\0402950,\0405412,\0405060)\040group\040by\040psi.subscription_id;
select\040psi.subscription_id,\040count(*)\040from\040progress_push_event\040ppe\040inner\040join\040users\040u\040on\040u.id=ppe.user_id\040inner\040join\040comments\040c\040on\040c.user_id=u.id\040and\040ppe.activity_id=c.id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040where\040action='create'\040and\040activity_type='comment'\040group\040by\040psi.subscription_id;
select\040id,\040name,\040invitation_token\040from\040platform_subscription\040where\040id=1000;
use\040nomadic;
select\040id,\040name,\040invitation_token\040from\040platform_subscription\040where\040id=3373;
select\040id,\040name,\040invitation_token\040from\040platform_subscription\040where\040invitation_token\040is\040not\040null;
select\040*\040from\040subscription_history\040order\040by\040id\040desc\040limit1;
select\040*\040from\040subscription_history\040order\040by\040id\040desc\040limit;
select\040*\040from\040subscription_history\040order\040by\040id\040desc\040limit\0401;
use\040nomadic;
select\040*\040from\040subscription_history\040order\040by\040id\040desc\040limit\0401;
use\040nomadic;
\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latest\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040if\040(@latest\040is\040null)\040then
\040\040\040\040\040\040\040\040set\040@latest\040=\0400;
if\040(@latest\040is\040null)\040then\040\040\040\040\040\040\040\040\040set\040@latest\040=\0400;
\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latest;
else\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latest;
\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latest
\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
insert\040into\040analytics_active_users(dt,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latest\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latest
\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
insert\040into\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latest\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latest
\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
insert\040into\040analytics_active_users(dt,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latest\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latest\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040if\040(@latest\040is\040null)\040then
\040\040\040\040\040\040\040\040set\040@latest\040=\0400;
if\040(@latest\040is\040null)\040then\040\040\040\040\040\040\040\040\040set\040@latest\040=\0400;
\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latest;
else\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latest;
\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latest
\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
insert\040into\040analytics_active_users(dt,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latest\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latest
\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
insert\040into\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latest\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latest
\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
insert\040into\040analytics_active_users(dt,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latest\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
select
\040\040\040\040max(dt)\040into\040@latest
from
\040\040\040\040analytics_active_users;
select\040\040\040\040\040max(dt)\040into\040@latest\040from\040\040\040\040\040analytics_active_users;
if\040(@latest\040is\040null)\040then
set
\040\040\040\040@latest\040=\0400;
if\040(@latest\040is\040null)\040then\040set\040\040\040\040\040@latest\040=\0400;
else
delete\040from
\040\040\040\040analytics_active_users
where
\040\040\040\040dt\040=\040@latest;
else\040delete\040from\040\040\040\040\040analytics_active_users\040where\040\040\040\040\040dt\040=\040@latest;
end\040if;
insert\040into
\040\040\040\040analytics_active_users(
\040\040\040\040\040\040\040\040dt,
\040\040\040\040\040\040\040\040edition_id,
\040\040\040\040\040\040\040\040program_id,
\040\040\040\040\040\040\040\040wave_id,
\040\040\040\040\040\040\040\040team_id,
\040\040\040\040\040\040\040\040fm_id,
\040\040\040\040\040\040\040\040user_id
\040\040\040\040)
select
\040\040\040\040DATE(pv.viewed),
\040\040\040\040p.edition_id,
\040\040\040\040p.id,
\040\040\040\040g.group_set_id,
\040\040\040\040pv.group_id,
\040\040\040\040pg.segment_id,
\040\040\040\040pv.user_id
from
\040\040\040\040pageviews\040pv
\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id
\040\040\040\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040inner\040join\040groups\040g\040on\040g.id\040=\040pv.group_id
\040\040\040\040inner\040join\040programs\040p\040on\040p.id\040=\040g.program_id
\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id\040=\040pv.page_id
where
\040\040\040\040pv.viewed\040>=\040@latest
group\040by
\040\040\040\040DATE(pv.viewed),
\040\040\040\040p.edition_id,
\040\040\040\040p.id,
\040\040\040\040g.group_set_id,
\040\040\040\040pv.group_id,
\040\040\040\040pg.segment_id,
\040\040\040\040pv.user_id;
insert\040into\040\040\040\040\040analytics_active_users(\040\040\040\040\040\040\040\040\040dt,\040\040\040\040\040\040\040\040\040edition_id,\040\040\040\040\040\040\040\040\040program_id,\040\040\040\040\040\040\040\040\040wave_id,\040\040\040\040\040\040\040\040\040team_id,\040\040\040\040\040\040\040\040\040fm_id,\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040select\040\040\040\040\040DATE(pv.viewed),\040\040\040\040\040p.edition_id,\040\040\040\040\040p.id,\040\040\040\040\040g.group_set_id,\040\040\040\040\040pv.group_id,\040\040\040\040\040pg.segment_id,\040\040\040\040\040pv.user_id\040from\040\040\040\040\040pageviews\040pv\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040\040\040\040\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id\040=\040pv.group_id\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id\040=\040g.program_id\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id\040=\040pv.page_id\040where\040\040\040\040\040pv.viewed\040>=\040@latest\040group\040by\040\040\040\040\040DATE(pv.viewed),\040\040\040\040\040p.edition_id,\040\040\040\040\040p.id,\040\040\040\040\040g.group_set_id,\040\040\040\040\040pv.group_id,\040\040\040\040\040pg.segment_id,\040\040\040\040\040pv.user_id;
insert\040into
\040\040\040\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)
select
\040\040\040\040DATE(rv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040rv.resource_id,
\040\040\040\040rv.user_id
from
\040\040\040\040resource_view\040rv
\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
where
\040\040\040\040rv.viewed\040>=\040@latest
group\040by
\040\040\040\040DATE(rv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040rv.resource_id,
\040\040\040\040rv.user_id;
insert\040into\040\040\040\040\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)\040select\040\040\040\040\040DATE(rv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040rv.resource_id,\040\040\040\040\040rv.user_id\040from\040\040\040\040\040resource_view\040rv\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040where\040\040\040\040\040rv.viewed\040>=\040@latest\040group\040by\040\040\040\040\040DATE(rv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040rv.resource_id,\040\040\040\040\040rv.user_id;
insert\040into
\040\040\040\040analytics_active_users(
\040\040\040\040\040\040\040\040dt,
\040\040\040\040\040\040\040\040edition_id,
\040\040\040\040\040\040\040\040community_channel_id,
\040\040\040\040\040\040\040\040community_edition_id,
\040\040\040\040\040\040\040\040user_id
\040\040\040\040)
select
\040\040\040\040DATE(cv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040cp.channel_id,
\040\040\040\040cp.edition_id,
\040\040\040\040cv.user_id
from
\040\040\040\040community_view\040cv
\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id\040=\040cv.community_post_id
where
\040\040\040\040cv.viewed\040>=\040@latest
group\040by
\040\040\040\040DATE(cv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040cp.channel_id,
\040\040\040\040cp.edition_id,
\040\040\040\040cv.user_id;
insert\040into\040\040\040\040\040analytics_active_users(\040\040\040\040\040\040\040\040\040dt,\040\040\040\040\040\040\040\040\040edition_id,\040\040\040\040\040\040\040\040\040community_channel_id,\040\040\040\040\040\040\040\040\040community_edition_id,\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040select\040\040\040\040\040DATE(cv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040cp.channel_id,\040\040\040\040\040cp.edition_id,\040\040\040\040\040cv.user_id\040from\040\040\040\040\040community_view\040cv\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id\040=\040cv.community_post_id\040where\040\040\040\040\040cv.viewed\040>=\040@latest\040group\040by\040\040\040\040\040DATE(cv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040cp.channel_id,\040\040\040\040\040cp.edition_id,\040\040\040\040\040cv.user_id;
select
\040\040\040\040max(dt)\040into\040@latest
from
\040\040\040\040analytics_active_users;
select\040\040\040\040\040max(dt)\040into\040@latest\040from\040\040\040\040\040analytics_active_users;
if\040(@latest\040is\040null)\040then
set
\040\040\040\040@latest\040=\0400;
if\040(@latest\040is\040null)\040then\040set\040\040\040\040\040@latest\040=\0400;
else
delete\040from
\040\040\040\040analytics_active_users
where
\040\040\040\040dt\040=\040@latest;
else\040delete\040from\040\040\040\040\040analytics_active_users\040where\040\040\040\040\040dt\040=\040@latest;
end\040if;
if\040(@latest\040is\040null)\040then
set
\040\040\040\040@latest\040=\0400
else
delete\040from
\040\040\040\040analytics_active_users
where
\040\040\040\040dt\040=\040@latest
end\040if;
if\040(@latest\040is\040null)\040then\040set\040\040\040\040\040@latest\040=\0400\040\040else\040delete\040from\040\040\040\040\040analytics_active_users\040where\040\040\040\040\040dt\040=\040@latest\040\040end\040if;
delete\040from
\040\040\040\040analytics_active_users
where
\040\040\040\040dt\040=\040@latest;
delete\040from\040\040\040\040\040analytics_active_users\040where\040\040\040\040\040dt\040=\040@latest;
insert\040into
\040\040\040\040analytics_active_users(
\040\040\040\040\040\040\040\040dt,
\040\040\040\040\040\040\040\040edition_id,
\040\040\040\040\040\040\040\040program_id,
\040\040\040\040\040\040\040\040wave_id,
\040\040\040\040\040\040\040\040team_id,
\040\040\040\040\040\040\040\040fm_id,
\040\040\040\040\040\040\040\040user_id
\040\040\040\040)
select
\040\040\040\040DATE(pv.viewed),
\040\040\040\040p.edition_id,
\040\040\040\040p.id,
\040\040\040\040g.group_set_id,
\040\040\040\040pv.group_id,
\040\040\040\040pg.segment_id,
\040\040\040\040pv.user_id
from
\040\040\040\040pageviews\040pv
\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id
\040\040\040\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040inner\040join\040groups\040g\040on\040g.id\040=\040pv.group_id
\040\040\040\040inner\040join\040programs\040p\040on\040p.id\040=\040g.program_id
\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id\040=\040pv.page_id
where
\040\040\040\040pv.viewed\040>=\040@latest
group\040by
\040\040\040\040DATE(pv.viewed),
\040\040\040\040p.edition_id,
\040\040\040\040p.id,
\040\040\040\040g.group_set_id,
\040\040\040\040pv.group_id,
\040\040\040\040pg.segment_id,
\040\040\040\040pv.user_id;
insert\040into\040\040\040\040\040analytics_active_users(\040\040\040\040\040\040\040\040\040dt,\040\040\040\040\040\040\040\040\040edition_id,\040\040\040\040\040\040\040\040\040program_id,\040\040\040\040\040\040\040\040\040wave_id,\040\040\040\040\040\040\040\040\040team_id,\040\040\040\040\040\040\040\040\040fm_id,\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040select\040\040\040\040\040DATE(pv.viewed),\040\040\040\040\040p.edition_id,\040\040\040\040\040p.id,\040\040\040\040\040g.group_set_id,\040\040\040\040\040pv.group_id,\040\040\040\040\040pg.segment_id,\040\040\040\040\040pv.user_id\040from\040\040\040\040\040pageviews\040pv\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040\040\040\040\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id\040=\040pv.group_id\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id\040=\040g.program_id\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id\040=\040pv.page_id\040where\040\040\040\040\040pv.viewed\040>=\040@latest\040group\040by\040\040\040\040\040DATE(pv.viewed),\040\040\040\040\040p.edition_id,\040\040\040\040\040p.id,\040\040\040\040\040g.group_set_id,\040\040\040\040\040pv.group_id,\040\040\040\040\040pg.segment_id,\040\040\040\040\040pv.user_id;
insert\040into
\040\040\040\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)
select
\040\040\040\040DATE(rv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040rv.resource_id,
\040\040\040\040rv.user_id
from
\040\040\040\040resource_view\040rv
\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
where
\040\040\040\040rv.viewed\040>=\040@latest
group\040by
\040\040\040\040DATE(rv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040rv.resource_id,
\040\040\040\040rv.user_id;
insert\040into\040\040\040\040\040analytics_active_users(dt,\040edition_id,\040resource_id,\040user_id)\040select\040\040\040\040\040DATE(rv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040rv.resource_id,\040\040\040\040\040rv.user_id\040from\040\040\040\040\040resource_view\040rv\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040where\040\040\040\040\040rv.viewed\040>=\040@latest\040group\040by\040\040\040\040\040DATE(rv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040rv.resource_id,\040\040\040\040\040rv.user_id;
insert\040into
\040\040\040\040analytics_active_users(
\040\040\040\040\040\040\040\040dt,
\040\040\040\040\040\040\040\040edition_id,
\040\040\040\040\040\040\040\040community_channel_id,
\040\040\040\040\040\040\040\040community_edition_id,
\040\040\040\040\040\040\040\040user_id
\040\040\040\040)
select
\040\040\040\040DATE(cv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040cp.channel_id,
\040\040\040\040cp.edition_id,
\040\040\040\040cv.user_id
from
\040\040\040\040community_view\040cv
\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id\040=\040cv.community_post_id
where
\040\040\040\040cv.viewed\040>=\040@latest
group\040by
\040\040\040\040DATE(cv.viewed),
\040\040\040\040u.edition_id,
\040\040\040\040cp.channel_id,
\040\040\040\040cp.edition_id,
\040\040\040\040cv.user_id;
insert\040into\040\040\040\040\040analytics_active_users(\040\040\040\040\040\040\040\040\040dt,\040\040\040\040\040\040\040\040\040edition_id,\040\040\040\040\040\040\040\040\040community_channel_id,\040\040\040\040\040\040\040\040\040community_edition_id,\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040select\040\040\040\040\040DATE(cv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040cp.channel_id,\040\040\040\040\040cp.edition_id,\040\040\040\040\040cv.user_id\040from\040\040\040\040\040community_view\040cv\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id\040=\040cv.community_post_id\040where\040\040\040\040\040cv.viewed\040>=\040@latest\040group\040by\040\040\040\040\040DATE(cv.viewed),\040\040\040\040\040u.edition_id,\040\040\040\040\040cp.channel_id,\040\040\040\040\040cp.edition_id,\040\040\040\040\040cv.user_id;
select\040*\040from\040analytics_active_users\040order\040by\040dt\040desc\040limit\0405;
select\040aau.*,\040psi.subscription_id\040from\040analytics_active_users\040aau\040inner\040join\040users\040u\040on\040u.id=aau.user_id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040order\040by\040dt\040desc\040limit\0405;
begin;
update\040editions\040set\040custify_last_run='2022-01-15'\040where\040id=71;
commit;
select\040aau.*,\040psi.subscription_id\040from\040analytics_active_users\040aau\040inner\040join\040users\040u\040on\040u.id=aau.user_id\040inner\040join\040platform_subscription_invitation\040psi\040on\040psi.user_id=u.id\040order\040by\040dt\040desc\040limit\0405;
select\040custify_last_run\040from\040editions\040where\040id=71;
select\040*\040from\040progress_push_edition_filter;
show\040tables
;
select\040*\040from\040progress_push_event_edition_filter;
select\040enabled\040from\040editions\040where\040id=71;
update\040editions\040set\040enabled=1\040where\040id=71;
delimiter\040;;
create\040procedure\040build_active_user_data_with_latest()
begin
\040\040\040\040select\040max(dt)\040into\040@latest\040from\040analytics_active_users;
\040\040\040\040if\040(@latest\040is\040null)\040then
\040\040\040\040set\040@latest\040=\0400;
\040\040\040\040else
\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latest;
\040\040\040\040end\040if;
\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040select\040DATE(pv.viewed),\040pv.viewed,\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040from\040pageviews\040pv
\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040where\040pv.viewed\040>=\040@latest
\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040select\040DATE(rv.viewed),\040rv.viewed,\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040from\040resource_view\040rv
\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040where\040rv.viewed\040>=\040@latest
\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040select\040DATE(cv.viewed),\040cv.viewed,\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040from\040community_view\040cv
\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040where\040cv.viewed\040>=\040@latest
\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
end;;
create\040procedure\040build_active_user_data_with_latest()\040begin\040\040\040\040\040select\040max(dt)\040into\040@latest\040from\040analytics_active_users;\040\040\040\040\040\040if\040(@latest\040is\040null)\040then\040\040\040\040\040set\040@latest\040=\0400;\040\040\040\040\040else\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latest;\040\040\040\040\040end\040if;\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040select\040DATE(pv.viewed),\040pv.viewed,\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040where\040pv.viewed\040>=\040@latest\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040select\040DATE(rv.viewed),\040rv.viewed,\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040where\040rv.viewed\040>=\040@latest\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040select\040DATE(cv.viewed),\040cv.viewed,\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040where\040cv.viewed\040>=\040@latest\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040end;;
delimiter\040;
user\040nomadic;
select\040*\040from\040saml_provider\040where\040id=43\134G
use\040nomadic;
select\040*\040from\040saml_provider\040where\040id=43\134G
select\040*\040from\040license_consumed;
delete\040from\040license_consumed;
select\040*\040from\040profile_field_value\040where\040field_id=22\040and\040user_id=180345;
select\040*\040from\040profile_field\040where\040id=22;
insert\040into\040profile_field_value(value,\040field_id,\040user_id)\040values('TEST02',\04022,\040180345);
select\040*\040from\040license_consumed;
select\040*\040from\040editions\040where\040external_ident_field_id\040is\040not\040null;
select\040*\040from\040editions\040where\040external_ident_field_id\040is\040not\040null\134G
update\040editions\040set\040external_ident_field_id=22\040where\040id=71;
select\040*\040from\040license_consumed;
use\040nomadic;
select\040*\040from\040license_consumed;
use\040nomadic;
\040\040\040\040\040\040\040\040delimiter\040;;
\040\040\040\040\040\040\040\040create\040procedure\040build_active_user_data_with_latest()
\040\040\040\040\040\040\040\040begin
\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040pv.viewed,\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040rv.viewed,\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040cv.viewed,\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
\040\040\040\040\040\040\040\040end;;
create\040procedure\040build_active_user_data_with_latest()\040\040\040\040\040\040\040\040\040begin\040\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040pv.viewed,\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040rv.viewed,\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040cv.viewed,\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040\040\040\040\040\040\040\040\040end;;
DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data_with_latest;
;
()
;
delimiter\040;
DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data_with_latest;
use\040nomadic;
DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data_with_latest;
delimiter\040;;
\040\040\040\040\040\040\040\040create\040procedure\040build_active_user_data_with_latest()
\040\040\040\040\040\040\040\040begin
\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
\040\040\040\040\040\040\040\040end;;
create\040procedure\040build_active_user_data_with_latest()\040\040\040\040\040\040\040\040\040begin\040\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040\040\040\040\040\040\040\040\040end;;
\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
;
;;
select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040;\040;;;
delimiter\040;
select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
@latestday;
@latestday
;
select\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
inner\040join\040programs\040p\040on\040p.id=g.program_id
inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
where\040pv.viewed\040>=\040@latestday
group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040where\040pv.viewed\040>=\040@latestday\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latest
\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latest\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
inner\040join\040programs\040p\040on\040p.id=g.program_id
inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
inner\040join\040programs\040p\040on\040p.id=g.program_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id;
select\040@latest;
select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
inner\040join\040programs\040p\040on\040p.id=g.program_id
inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
use\040nomadic;
select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
inner\040join\040programs\040p\040on\040p.id=g.program_id
inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
inner\040join\040programs\040p\040on\040p.id=g.program_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040g.group_set_id,\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040g.group_set_id,\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040g.group_set_id,\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040g.group_set_id,\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040groups\040g\040on\040g.id=pv.group_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040groups\040g\040on\040g.id=pv.group_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
describe\040groups;
describe\040group;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id
from\040pageviews\040pv
inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
inner\040join\040`groups`\040g\040on\040g.id=pv.group_id
where\040pv.viewed\040>=\040@latest
group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
select\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id\040from\040pageviews\040pv\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id\040where\040pv.viewed\040>=\040@latest\040group\040by\040DATE(pv.viewed),\040pv.group_id,\040pv.user_id;
\040\040\040\040\040\040\040\040DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data_with_latest;
\040\040\040\040\040\040\040\040delimiter\040;;
\040\040\040\040\040\040\040\040create\040procedure\040build_active_user_data_with_latest()
\040\040\040\040\040\040\040\040begin
\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
\040\040\040\040\040\040\040\040end
\040\040\040\040\040\040\040\040;;
create\040procedure\040build_active_user_data_with_latest()\040\040\040\040\040\040\040\040\040begin\040\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040\040\040\040\040\040\040\040\040end;;
\040\040\040\040\040\040\040\040delimiter\040;
describe\040analytics_active_users;
call\040DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data_with_latest;
DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data_with_latest;
\040\040\040\040\040\040\040\040DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data;
\040\040\040\040\040\040\040\040delimiter\040;;
\040\040\040\040\040\040\040\040create\040procedure\040build_active_user_data()
\040\040\040\040\040\040\040\040begin
\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
\040\040\040\040\040\040\040\040end
\040\040\040\040\040\040\040\040;;
create\040procedure\040build_active_user_data()\040\040\040\040\040\040\040\040\040begin\040\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040\040\040\040\040\040\040\040\040end;;
\040\040\040\040\040\040\040\040delimiter\040;
call\040build_active_user_data();
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
call\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
call\040build_active_user_data()
;
select\040*\040from\040analytics_active_users\040order\040by\040id\040desc\040limit\0405;
select\040*\040from\040pageviews\040limit\0401;
alter\040table\040analytics_active_users\040drop\040column\040latest;
\040\040\040\040\040\040\040\040DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data;
\040\040\040\040\040\040\040\040delimiter\040;;
\040\040\040\040\040\040\040\040create\040procedure\040build_active_user_data()
\040\040\040\040\040\040\040\040begin
\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
\040\040\040\040\040\040\040\040end
\040\040\040\040\040\040\040\040;;
create\040procedure\040build_active_user_data()\040\040\040\040\040\040\040\040\040begin\040\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040\040\040\040\040\040\040\040\040end;;
\040\040\040\040\040\040\040\040delimiter\040;
select\040*\040from\040alembic_version;
\040\040\040\040\040\040\040\040DROP\040PROCEDURE\040IF\040EXISTS\040build_active_user_data;
\040\040\040\040\040\040\040\040delimiter\040;;
\040\040\040\040\040\040\040\040create\040procedure\040build_active_user_data()
\040\040\040\040\040\040\040\040begin
\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;
\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then
\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;
\040\040\040\040\040\040\040\040\040\040\040\040else
\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;
\040\040\040\040\040\040\040\040\040\040\040\040end\040if;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)
\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id
\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id
\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday
\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;
\040\040\040\040\040\040\040\040end
\040\040\040\040\040\040\040\040;;
create\040procedure\040build_active_user_data()\040\040\040\040\040\040\040\040\040begin\040\040\040\040\040\040\040\040\040\040\040\040\040select\040max(dt)\040into\040@latestday\040from\040analytics_active_users;\040\040\040\040\040\040\040\040\040\040\040\040\040\040if\040(@latestday\040is\040null)\040then\040\040\040\040\040\040\040\040\040\040\040\040\040set\040@latestday\040=\0400;\040\040\040\040\040\040\040\040\040\040\040\040\040else\040\040\040\040\040\040\040\040\040\040\040\040\040delete\040from\040analytics_active_users\040where\040dt\040=\040@latestday;\040\040\040\040\040\040\040\040\040\040\040\040\040end\040if;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040program_id,\040wave_id,\040team_id,\040fm_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(pv.viewed),\040max(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040pageviews\040pv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040groupusers\040gu\040on\040gu.user_id\040=\040pv.user_id\040and\040gu.group_id\040=\040pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040`groups`\040g\040on\040g.id=pv.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040pages\040pg\040on\040pg.id=pv.page_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040pv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(pv.viewed),\040p.edition_id,\040p.id,\040g.group_set_id,\040pv.group_id,\040pg.segment_id,\040pv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040resource_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(rv.viewed),\040max(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040resource_view\040rv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040rv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040rv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(rv.viewed),\040u.edition_id,\040rv.resource_id,\040rv.user_id;\040\040\040\040\040\040\040\040\040\040\040\040\040\040insert\040into\040analytics_active_users(dt,\040latest,\040edition_id,\040community_channel_id,\040community_edition_id,\040user_id)\040\040\040\040\040\040\040\040\040\040\040\040\040select\040DATE(cv.viewed),\040max(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040from\040community_view\040cv\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040users\040u\040on\040u.id\040=\040cv.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040join\040community_post\040cp\040on\040cp.id=cv.community_post_id\040\040\040\040\040\040\040\040\040\040\040\040\040where\040cv.viewed\040>=\040@latestday\040\040\040\040\040\040\040\040\040\040\040\040\040group\040by\040DATE(cv.viewed),\040u.edition_id,\040cp.channel_id,\040cp.edition_id,\040cv.user_id;\040\040\040\040\040\040\040\040\040end;;
\040\040\040\040\040\040\040\040delimiter\040;
show\040create\040procedure\040build_active_user_data;
describe\040analytics_active_users;
alter\040table\040analytics_active_users\040drop\040column\040latest;
show\040create\040procedure\040build_active_user_data;
call\040build_active_user_data()
;
use\040nomadic;
select\040id,\040name\040from\040editions\040where\040custify_last_run;
select\040id,\040name,\040custify_last_run\040from\040editions\040where\040custify_last_run\040is\040not\040null;
select\040*\040from\040analytics_active_users\040where\040dt>'2022-01-15';
use\040nomadic;
select\040*\040from\040analytics_active_users\040where\040dt>'2022-01-15';
update\040analytics_active_users\040set\040latest=dt;
select\040*\040from\040analytics_active_users\040where\040dt>'2022-01-15';
call\040build_active_user_data()
;
select\040*\040from\040analytics_active_users\040where\040dt>'2022-01-15';
select\040id,\040name,\040custify_last_run\040from\040editions\040where\040id=71;
call\040build_active_user_data();
select\040*\040from\040analytics_active_users\040where\040dt>'2022-01-15';
select\040id,\040name,\040custify_last_run\040from\040editions\040where\040id=71;
select\040*\040from\040analytics_active_users\040where\040dt>'2022-01-15';
call\040build_active_user_data();
use\040nomadic;
select\040*\040from\040analytics_active_users\040where\040dt>'2022-01-15';
use\040nomadic;
select\040*\040from\040program_survey;
show\040tables;
select\040*\040from\040survey;
select\040*\040from\040survey_question;
select\040*\040from\040editions\040where\040post_program_survey\040is\040not\040NULL;
select\040*\040from\040editions\040where\040post_program_survey_id\040is\040not\040NULL;
select\040*\040from\040editions\040where\040post_program_survey_id\040is\040not\040NULL\134G
describe\040program_completion_log;
[Finsert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100)
;
insert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100);
select\040*\040from\040survey_answer;
delete\040from\040survey_answer;
select\040*\040from\040survey_question;
insert\040into\040survey_question\040values(1,\0400\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likertnotext',\0401)
;
insert\040into\040survey_question\040values(1,\0400\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likertnotext',\0401)
;
insert\040into\040survey_question()\040values(1,\0400\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likertnotext',\0401)
;
insert\040into\040survey_question(survey_id,question_order,question_content,question_type,active)\040values(1,\0400\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likertnotext',\0401)
;
insert\040into\040survey_question(survey_id,question_order,question_content,question_type,active)\040values\040(1,\0400\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likertnotext',\0401);
insert\040into\040survey_question(survey_id,question_order,question_content,question_type,active)\040values\040(1,\0400,\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likertnotext',\0401);
insert\040into\040survey_question(survey_id,question_order,question_content,question_type,active)\040values\040(1,\0400,\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likert-notext',\0401);
describe\040survey_question;
select\040*\040from\040survey_question;
delete\040from\040survey_question\040where\040id=7;
describe\040survey_question;
insert\040into\040survey_question(survey_id,question_order,question_content,question_type,active)\040values\040(1,\0400,\040'<h2>Overall,\040how\040would\040you\040rate\040this\040program?</h2>',\040'likert-notext',\0401);
insert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100);
select\040*\040from\040survey_answer;
insert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100);
delete\040from\040survey_question\040where\040id=7;
delete\040from\040survey_question;
delete\040from\040survey_answer;
delete\040from\040survey_question\040where\040id=8;;
select\040*\040from\040survey_question;
use\040nomadic;
select\040user_id,\040max(latest)\040from\040analytics_active_users\040aau\040group\040by\040user_id;
select\040u.id,\040max(t1.latest,\040l.last_login)\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040inner\040join\040(select\040user_id,\040max(latest)\040as\040'latest'\040from\040analytics_active_users\040aau\040group\040by\040user_id)\040t1\040on\040t1.user_id=u.id;
select\040u.id,\040greatest(t1.latest,\040l.last_login)\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040inner\040join\040(select\040user_id,\040max(latest)\040as\040'latest'\040from\040analytics_active_users\040aau\040group\040by\040user_id)\040t1\040on\040t1.user_id=u.id;
select\040u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile,\040,last_viewed_conversations,\040u.last_viewed_community,\040t1.latest,\040l.first_login,\040l.last_login,\040greatest(u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile,\040,last_viewed_conversations,\040u.last_viewed_community,\040t1.latest,\040l.first_login,\040l.last_login)\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040inner\040join\040(select\040user_id,\040max(latest)\040as\040'latest'\040from\040analytics_active_users\040aau\040group\040by\040user_id)\040t1\040on\040t1.user_id=u.id;
select\040u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile,\040,last_viewed_conversations,\040u.last_viewed_community,\040t1.latest,\040l.first_login,\040l.last_login,\040greatest(u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile,\040last_viewed_conversations,\040u.last_viewed_community,\040t1.latest,\040l.first_login,\040l.last_login)\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040inner\040join\040(select\040user_id,\040max(latest)\040as\040'latest'\040from\040analytics_active_users\040aau\040group\040by\040user_id)\040t1\040on\040t1.user_id=u.id;
select\040u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile,\040last_viewed_conversations,\040u.last_viewed_community,\040t1.latest,\040l.first_login,\040l.last_login,\040greatest(u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile,\040last_viewed_conversations,\040u.last_viewed_community,\040t1.latest,\040l.first_login,\040l.last_login)\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040inner\040join\040(select\040user_id,\040max(latest)\040as\040'latest'\040from\040analytics_active_users\040aau\040group\040by\040user_id)\040t1\040on\040t1.user_id=u.id;
select\040u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profiledated_profile,\040last_viewed_conversations,\040u.last_viewed_community,\040t1.latest,\040l.first_login,\040l.last_login)\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040inner\040join\040(select\040user_id,\040max(latest)\040as\040'latest'\040from\040analytics_active_users\040aau\040group\040by\040user_id)\040t1\040on\040t1.user_id=u.id;
select\040u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile,\040greatest(u.last_viewed_activity,\040u.last_viewed_notifications,\040u.last_updated_profile)\040from\040users\040u\040inner\040join\040logins\040l\040on\040l.id=u.login_id\040inner\040join\040(select\040user_id,\040max(latest)\040as\040'latest'\040from\040analytics_active_users\040aau\040group\040by\040user_id)\040t1\040on\040t1.user_id=u.id;
begin;
update
\040\040\040\040users\040u
set
\040\040\040\040u.last_activity\040=\040greatest(
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),
\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),
\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),
\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),
\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)
\040\040\040\040)
)
from
\040\040\040\040users\040u
\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id
\040\040\040\040inner\040join\040(
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id
\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id;
update\040\040\040\040\040users\040u\040set\040\040\040\040\040u.last_activity\040=\040greatest(\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),\040\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),\040\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)\040\040\040\040\040)\040)\040from\040\040\040\040\040users\040u\040\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id\040\040\040\040\040inner\040join\040(\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id;
update
\040\040\040\040users\040u
set
\040\040\040\040u.last_activity\040=\040greatest(
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),
\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),
\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),
\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),
\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)
\040\040\040\040)
from
\040\040\040\040users\040u
\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id
\040\040\040\040inner\040join\040(
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id
\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id;
update\040\040\040\040\040users\040u\040set\040\040\040\040\040u.last_activity\040=\040greatest(\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),\040\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),\040\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)\040\040\040\040\040)\040from\040\040\040\040\040users\040u\040\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id\040\040\040\040\040inner\040join\040(\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id;
update
\040\040\040\040users\040u
from
\040\040\040\040users\040u
\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id
\040\040\040\040inner\040join\040(
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id
\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id
set
\040\040\040\040u.last_activity\040=\040greatest(
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),
\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),
\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),
\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),
\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)
\040\040\040\040);
update\040\040\040\040\040users\040u\040from\040\040\040\040\040users\040u\040\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id\040\040\040\040\040inner\040join\040(\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id\040set\040\040\040\040\040u.last_activity\040=\040greatest(\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),\040\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),\040\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)\040\040\040\040\040);
update
\040\040\040\040users\040u
\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id
\040\040\040\040inner\040join\040(
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id
\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id
set
\040\040\040\040u.last_activity\040=\040greatest(
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),
\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),
\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),
\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),
\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)
\040\040\040\040);
update\040\040\040\040\040users\040u\040\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id\040\040\040\040\040inner\040join\040(\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id\040set\040\040\040\040\040u.last_activity\040=\040greatest(\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),\040\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),\040\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)\040\040\040\040\040);
describe\040users;
update
\040\040\040\040users\040u
\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id
\040\040\040\040inner\040join\040(
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id
\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id
set
\040\040\040\040u.last_accessed\040=\040greatest(
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),
\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),
\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),
\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),
\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)
\040\040\040\040);
update\040\040\040\040\040users\040u\040\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id\040\040\040\040\040inner\040join\040(\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id\040set\040\040\040\040\040u.last_accessed\040=\040greatest(\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_updated_profiledated_profile,\0400),\040\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),\040\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)\040\040\040\040\040);
update
\040\040\040\040users\040u
\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id
\040\040\040\040inner\040join\040(
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id
\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id
set
\040\040\040\040u.last_accessed\040=\040greatest(
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_updated_profile,\0400),
\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),
\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),
\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),
\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)
\040\040\040\040);
update\040\040\040\040\040users\040u\040\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id\040\040\040\040\040inner\040join\040(\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id\040set\040\040\040\040\040u.last_accessed\040=\040greatest(\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_updated_profile,\0400),\040\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),\040\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)\040\040\040\040\040);
select\040*\040from\040users;
use\040nomadic;
select\040*\040from\040license_consumption_edition_reason;
select\040*\040from\040license_consumed;
select\040*\040from\040license_consumed\040lc\040inner\040join\040users\040u\040on\040u.id=lc.user_id;
use\040nomadic;
select\040*\040from\040license_consumption_period;
show\040tables;
select\040*\040from\040license_period;
insert\040into\040license_period()\040values(71,\040'2022-04-05',\040NULL,\040NULL,\040NULL,\0400,\040NULL);
insert\040into\040license_period()\040values(2,\04071,\040'2022-04-05',\040NULL,\040NULL,\040NULL,\0400,\040NULL);
insert\040into\040license_period(edition_id,\040start_date)\040values(71,\040'2022-04-05');
insert\040into\040license_period(edition_id,\040start_date,\040is_subscription_template)\040values(71,\040'2022-04-05',\0400);
select\040*\040from\040license_period;
update\040license_period\040set\040end_date='2022-04-05\04000:00:00'\040where\040id=1;
select\040*\040from\040license_consumption_edition_reason;
select\040*\040from\040license_consumed;
select\040*\040from\040license_period;
select\040*\040from\040platform_subscription;
use\040nomadic;
select\040*\040from\040license_period;
select\040*\040from\040license_consumed;
select\040*\040from\040excel_group_report\040order\040by\040id\040desc\040limit\0405;
select\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr_user_id\040order\040by\040id\040desc\040limit\0405;
select\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.user_id\040order\040by\040id\040desc\040limit\0405;
select\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040order\040by\040id\040desc\040limit\0405;
select\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040order\040by\040egr.id\040desc\040limit\0405;
select\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040order\040by\040egr.id\040desc\040limit\04010;
select\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040order\040by\040egr.id\040desc\040limit\04015;
select\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040order\040by\040egr.id\040desc\040limit\04025;
select\040egr.*,\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040order\040by\040egr.id\040desc\040limit\04025;
select\040egr.*,\040u.edition_id,\040u.first_name,\040u.last_name\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040order\040by\040egr.id\040desc\040limit\04025;
use\040nomadic;
select\040*\040from\040users\040order\040by\040id\040desc\040limit\0405\134G
select\040count(*)\040from\040users\040where\040last_accessed\040is\040not\040null;
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id;
select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id;
select\040\040from\040\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id;
select\040\040from\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id;
\040\040\040\040select\040u.id,\040greatest(
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_updated_profile,\0400),
\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),
\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),
\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),
\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),
\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)
\040\040\040\040)
\040\040\040\040from
\040\040\040\040users\040u
\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id
\040\040\040\040inner\040join\040(
\040\040\040\040\040\040\040\040select
\040\040\040\040\040\040\040\040\040\040\040\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'
\040\040\040\040\040\040\040\040from
\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau
\040\040\040\040\040\040\040\040group\040by
\040\040\040\040\040\040\040\040\040\040\040\040user_id
\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id;
select\040u.id,\040greatest(\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_activity,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_notifications,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_updated_profile,\0400),\040\040\040\040\040\040\040\040\040coalesce(last_viewed_conversations,\0400),\040\040\040\040\040\040\040\040\040coalesce(u.last_viewed_community,\0400),\040\040\040\040\040\040\040\040\040coalesce(t1.latest,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.first_login,\0400),\040\040\040\040\040\040\040\040\040coalesce(l.last_login,\0400)\040\040\040\040\040)\040\040\040\040\040from\040\040\040\040\040users\040u\040\040\040\040\040inner\040join\040logins\040l\040on\040l.id\040=\040u.login_id\040\040\040\040\040inner\040join\040(\040\040\040\040\040\040\040\040\040select\040\040\040\040\040\040\040\040\040\040\040\040\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(latest)\040as\040'latest'\040\040\040\040\040\040\040\040\040from\040\040\040\040\040\040\040\040\040\040\040\040\040analytics_active_users\040aau\040\040\040\040\040\040\040\040\040group\040by\040\040\040\040\040\040\040\040\040\040\040\040\040user_id\040\040\040\040\040)\040t1\040on\040t1.user_id\040=\040u.id;
describe\040users;
use\040nomadic;
describe\040users;
use\040nomadic;
select\040*\040from\040excel_group_report\040order\040by\040id\040desc\040limit\0401;
select\040*\040from\040excel_group_report\040order\040by\040id\040desc\040limit\0405;
select\040*\040from\040excel_group_report\040order\040by\040id\040desc\040limit\0403;
select\040*\040from\040excel_group_report\040order\040by\040id\040desc\040limit\0401;
describe\040excel_group_report;
select\040id,\040created,\040completed\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.user_id\040where\040u.edition_id=36\040order\040by\040id\040desc\040limit\0401;
select\040egr.id,\040created,\040completed\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.user_id\040where\040u.edition_id=36\040order\040by\040egr.id\040desc\040limit\0401;
select\040egr.id,\040egr.created,\040completed\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.user_id\040where\040u.edition_id=36\040order\040by\040egr.id\040desc\040limit\0401;
select\040egr.id,\040egr.created,\040completed\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040where\040u.edition_id=36\040order\040by\040egr.id\040desc\040limit\0401;
select\040id,\040name\040from\040editions\040where\040internal_name\040like\040'%bny%';
select\040egr.id,\040egr.created,\040completed\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040where\040u.edition_id=36\040order\040by\040egr.id\040desc\040limit\0401;
select\040egr.id,\040egr.created,\040completed\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040where\040u.edition_id=36\040order\040by\040egr.id\040desc\040limit\04010;
select\040egr.id,\040egr.created,\040completed\040from\040excel_group_report\040egr\040inner\040join\040users\040u\040on\040u.id=egr.creator_id\040where\040u.edition_id=36\040order\040by\040egr.id\040desc\040limit\040100;
select\040count(*)\040from\040excel_group_report;
use\040nomadic;
show\040processlist;
select\040month(g.start_date),\040count(*)\040from\040groups\040g\040inner\040join\040(select\040id\040from\040groups\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id\040group\040by\040month(g.start_date);
select\040MONTH(g.start_date),\040count(*)\040from\040groups\040g\040inner\040join\040(select\040id\040from\040groups\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id\040group\040by\040MONTH(g.start_date);
select\040count(*)\040from\040groups\040g\040inner\040join\040(select\040id\040from\040groups\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id;
describe\040group;
describe\040groups;
show\040tables;
describe\040groups;
select\040count(*)\040from\040groups;
select\040id\040from\040groups\040limit\0401;
select\040*\040from\040groups\040limit\0401;
describe\040viewtimelog;
describe\040groups;
describe\040`groups`;
select\040count(*)\040from\040`groups`\040g\040inner\040join\040(select\040id\040from\040`groups`\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id;
select\040count(*)\040from\040`groups`\040g\040inner\040join\040(select\040g.id\040from\040`groups`\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id;
select\040MONTH(g.start_date),\040count(*)\040from\040`groups`\040g\040inner\040join\040(select\040g.idid\040from\040`groups`\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id\040group\040by\040MONTH(g.start_date);
select\040MONTH(g.start_date),\040count(*)\040from\040`groups`\040g\040inner\040join\040(select\040g.id\040from\040`groups`\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id\040group\040by\040MONTH(g.start_date);
select\040YEAR(g.start_date),\040MONTH(g.start_date),\040count(*)\040from\040`groups`\040g\040inner\040join\040(select\040g.id\040from\040`groups`\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id\040group\040by\040YEAR(g.start_date),\040MONTH(g.start_date);
select\040YEAR(g.start_date),\040MONTH(g.start_date),\040count(*)\040from\040`groups`\040g\040inner\040join\040(select\040g.id\040from\040`groups`\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id\040group\040by\040YEAR(g.start_date),\040MONTH(g.start_date)\040order\040by\040YEAR(g.start_date),\040MONTH(g.start_date);
select\040YEAR(g.start_date),\040MONTH(g.start_date),\040count(*)\040from\040`groups`\040g\040inner\040join\040(select\040g.id\040from\040`groups`\040g\040inner\040join\040groupusers\040gu\040on\040gu.group_id=g.id\040group\040by\040g.id\040having\040count(*)\040>\04019)\040t1\040on\040t1.id=g.id\040where\040g.start_date\040<\040utc_timestamp()\040group\040by\040YEAR(g.start_date),\040MONTH(g.start_date)\040order\040by\040YEAR(g.start_date),\040MONTH(g.start_date);
select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040from\040comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted);
select\040t1.month,\040t1.year,\040t1.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1;
select\040t1.month,\040t1.year,\040t1.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
select\040t1.month,\040t1.year,\040t1.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
describe\040comments;
describe\040community_comment;
select\040t1.month,\040t1.year,\040t1.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040group\040by\040MONTH(c.created),\040YEAR(c.created))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
select\040t1.month,\040t1.year,\040t1.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.created)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040group\040by\040MONTH(c.created),\040YEAR(c.created))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
select\040t1.month,\040t1.year,\040t1.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.created)\040as\040'month',\040YEAR(c.created)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040group\040by\040MONTH(c.created),\040YEAR(c.created))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
select\040t1.month,\040t1.year,\040t1.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040where\040c.posted\040<\040utc_timestamp()\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.created)\040as\040'month',\040YEAR(c.created)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040where\040c.created\040<\040utc_timestamp()\040group\040by\040MONTH(c.created),\040YEAR(c.created))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
select\040t1.month,\040t1.year,\040t1.ct,\040t2.ct,\040ADD(t1.ct,\040t2.ct)\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040where\040c.posted\040<\040utc_timestamp()\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.created)\040as\040'month',\040YEAR(c.created)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040where\040c.created\040<\040utc_timestamp()\040group\040by\040MONTH(c.created),\040YEAR(c.created))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
select\040t1.month,\040t1.year,\040t1.ct,\040t2.ct,\040t1.ct\040+\040t2.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040where\040c.posted\040<\040utc_timestamp()\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.created)\040as\040'month',\040YEAR(c.created)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040where\040c.created\040<\040utc_timestamp()\040group\040by\040MONTH(c.created),\040YEAR(c.created))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year;
select\040t1.month,\040t1.year,\040t1.ct,\040t2.ct,\040t1.ct\040+\040t2.ct\040from\040(select\040MONTH(c.posted)\040as\040'month',\040YEAR(c.posted)\040as\040'year',\040count(*)\040as\040'ct'\040from\040comments\040c\040where\040c.posted\040<\040utc_timestamp()\040group\040by\040MONTH(c.posted),\040YEAR(c.posted))\040t1\040left\040outer\040join\040(select\040MONTH(c.created)\040as\040'month',\040YEAR(c.created)\040as\040'year',\040count(*)\040as\040'ct'\040from\040community_comment\040c\040where\040c.created\040<\040utc_timestamp()\040group\040by\040MONTH(c.created),\040YEAR(c.created))\040t2\040on\040t2.month=t1.month\040and\040t2.year=t1.year\040order\040by\040t1.year,\040t1.month;
use\040nomadic;
select\040id,\040name,\040internal_name\040from\040editions\040where\040name\040like\040'%abi%';
select\040id,\040name,\040internal_name\040from\040editions\040where\040internal_name\040like\040'%abi%';
select\040id,\040name,\040internal_name\040from\040editions\040where\040name\040like\040'%leadership%';
select\040id,\040name,\040internal_name\040from\040editions;
use\040nomadic;
select\040id,\040name\040from\040editions\040where\040id=36;
select\040id,\040name\040from\040editions\040where\040id=1;
select\040id,\040name\040from\040editions\040where\040id=11;
insert\040into\040license_period\040values(null,\04011,\040'2022-01-01\04000:00:00',\040null,\040null,\040'Started\040license\040consumption\040collection\040June\0402022,\040previously\040Citi\040had\040custom\040license\040report,\040data\040between\040Jan\040and\040June\040reconstructed\040from\040AAU\040data,\040citi_license_recon.sql',\040null,\0400,\040null);
insert\040into\040license_con':\040insert\040into\040license_consumption_edition_reason(reason_ref,\040edition_id)\040values('resource_view',\04011),\040('opened_program',\04011),\040('community_view',\04011);
insert\040into\040license_consumption_edition_reason(reason_ref,\040edition_id)\040values('resource_view',\04011),\040('opened_program',\04011),\040('community_view',\04011);
insert\040into\040license_period\040values(null,\04071,\040'2022-01-01\04000:00:00',\040null,\040null,\040'Started\040license\040consumption\040collection\040June\0402022,\040previously\040Citi\040had\040custom\040license\040report,\040data\040between\040Jan\040and\040June\040reconstructed\040from\040AAU\040data,\040citi_license_recon.sql',\040null,\0400,\040null);
insert\040into\040license_consumption_edition_reason(reason_ref,\040edition_id)\040values('resource_view',\04071),\040('opened_program',\04071),\040('community_view',\04071);
select\040*\040from\040license_consumed;
select\040*\040from\040license_period;
select\040*\040from\040license_period\040where\040edition_id=71;
select\040*\040from\040license_consumption_edition_reason;
select\040*\040from\040license_consumed;
delete\040from\040license\040period\040where\040id>5;
delete\040from\040license_period\040where\040id>5;
delete\040from\040license_consumed;
delete\040from\040license_period\040where\040id>5;
use\040nomadic;
select\040*\040from\040survey_answer;
select\040*\040from\040survey;
select\040*\040from\040survey_question;
select\040*\040from\040editions\040where\040post_program_survey_id\040is\040not\040null;
[Finsert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100);
insert\040into\040program_completion_log(user_id,\040group_id,\040posted,\040value)\040values\040(180345,\04017409,\040utc_timestamp(),\040100);
select\040*\040from\040survey_answer;
select\040edition_id\040from\040users\040where\040admin_analytics=1;
use\040nomadic;
select\040edition_id\040from\040users\040where\040admin_analytics=1;
select\040edition_id\040from\040users\040where\040admin_analytics=1\040and\040sales_admin=0;
select\040edition_id\040from\040users\040where\040admin_analytics=1;
select\040edition_id\040from\040users\040where\040admin_analytics=1\040and\040sales_admin=0;
select\040edition_id\040from\040users\040where\040admin_analytics=1\040and\040sales_admin=0\040and\040deleted=0;
select\040edition_id,\040deleted\040from\040users\040where\040admin_analytics=1\040and\040sales_admin=0;
select\040*\040from\040group_set\040where\040id=2132;
use\040nomadic;
update\040editions\040set\040name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\040where\040id=71;
update\040editions\040set\040name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\040where\040id=71;
update\040editions\040set\040name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\040where\040id=71;
use\040nomadic;
update\040editions\040set\040name='Josh\040Bersin\040Academy'\040where\040id=71;
select\040id,\040name\040from\040editions\040where\040name\040like\040'%marketing%';
select\040id,\040name\040from\040editions\040where\040name\040like\040'%pepsi%';
select\040id,\040name\040from\040editions\040where\040id=130;
select\040id\040from\040users\040where\040edition_id=130\040and\040edition_analytics=1;
describe\040users;
select\040id\040from\040users\040where\040edition_id=130\040and\040admin_analytics=1;
select\040id\040from\040users\040where\040edition_id=130\040and\040admin_analytics=1\040and\040sales_admin=0;
select\040id\040from\040users\040where\040last_name='Bassendine'\040and\040edition_id=130;
show\040tables;
describe\040access_role_user;
select\040*\040from\040access_role_permissions;
select\040*\040from\040access_role_permission;
insert\040into\040access_role_user(user_id,\040scoped_target_id,\040scoped_target_type,\040id)\040values('CustomerSupport',\040130,\040'edition',\040null);
select\040id\040from\040users\040where\040last_name='Bassendine'\040and\040edition_id=130;
insert\040into\040access_role_user(user_id,\040scoped_target_id,\040scoped_target_type,\040id)\040values(324421,\040'CustomerSupport',\040130,\040'edition',\040null);
insert\040into\040access_role_user(user_id,\040scoped_target_id,\040scoped_target_type,\040id)\040values(324421,\040130,\040'CustomerSupport',\040'edition',\040null);
insert\040into\040access_role_user(user_id,\040scoped_target_id,\040access_role_name,\040scoped_target_type,\040id)\040values(324421,\040130,\040'CustomerSupport',\040'edition',\040null);
select\040*\040from\040access_role_user;
select\040*\040from\040access_group_user;;
insert\040into\040access_group_user(user_id,\040access_group_name)\040values\040(324421,\040'DevTeam');
select\040id\040from\040users\040where\040admin_analytics=1;
select\040id,\040edition_id\040from\040users\040where\040admin_analytics=1;
select\040id,\040name\040from\040editions\040where\040edition_id=129;
select\040id,\040name\040from\040editions\040where\040id=129;
select\040id\040from\040users\040where\040admin_analytics=1\040and\040edition_id=129;
insert\040into\040access_group_user(user_id,\040access_group_name)\040values\040(309290,\040'DevTeam');
insert\040into\040access_group_user(user_id,\040access_group_name)\040values\040(308290,\040'DevTeam');
select\040id,\040name\040from\040editions\040where\040id=36;
select\040id,\040name\040from\040editions\040where\040id=130;
select\040id,\040name\040from\040editions\040where\040id=133;
use\040nomadic;
insert\040into\040access_role_group(access_role_name,\040access_group_name,\040scoped_target_type)\040values('JourneyEditor',\040'DevTeam',\040'global');
use\040nomadic;
insert\040into\040access_role_group(access_role_name,\040access_group_name,\040scoped_target_type)\040values('JourneyEditor',\040'DevTeam',\040'global');
select\040*\040from\040access_role_group;
begin;
delete\040from\040access_role_group\040where\040id=6;
begin;
commit;
select\040*\040from\040access_role_group;
select\040*\040from\040access_group_user;
select\040id\040from\040users\040where\040last_name\040='Bassendine'\040and\040edition_id=133;
[Finsert\040into\040access_group_user(user_id,\040access_group_name)\040values\040(347703,\040'DevTeam');
insert\040into\040access_group_user(user_id,\040access_group_name)\040values\040(347703,\040'DevTeam');
j
;
SELECT
\040\040\040\040resource.ref\040AS\040resource_ref
FROM
\040\040\040\040resource
\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id
\040\040\040\040JOIN\040(
\040\040\040\040\040\040\040\040achievement_step
\040\040\040\040\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id
\040\040\040\040)\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id
\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step_1\040ON\040achievement_step_1.id\040=\040achievement_step_1.id
\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id
WHERE
\040\040\040\040journey.id\040=\04030;
SELECT\040\040\040\040\040resource.ref\040AS\040resource_ref\040FROM\040\040\040\040\040resource\040\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040achievement_step\040\040\040\040\040\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id\040\040\040\040\040)\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id\040\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step_1\040ON\040achievement_step_1.id\040=\040achievement_step_1.id\040\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id\040WHERE\040\040\040\040\040journey.id\040=\04030;
use\040nomadic;
SELECT\040\040\040\040\040resource.ref\040AS\040resource_ref\040FROM\040\040\040\040\040resource\040\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id\040\040\040\040\040JOIN\040(\040\040\040\040\040\040\040\040\040achievement_step\040\040\040\040\040\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id\040\040\040\040\040)\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id\040\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step_1\040ON\040achievement_step_1.id\040=\040achievement_step_1.id\040\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id\040WHERE\040\040\040\040\040journey.id\040=\04030;
SELECT
\040\040\040\040resource.ref\040AS\040resource_ref
FROM
\040\040\040\040resource
\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id
\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id
\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step_1\040ON\040achievement_step_1.id\040=\040achievement_step_1.id
\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id
WHERE
\040\040\040\040journey.id\040=\04030;
SELECT\040\040\040\040\040resource.ref\040AS\040resource_ref\040FROM\040\040\040\040\040resource\040\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id\040\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id\040\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step_1\040ON\040achievement_step_1.id\040=\040achievement_step_1.id\040\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id\040WHERE\040\040\040\040\040journey.id\040=\04030;
SELECT
\040\040\040\040resource.ref\040AS\040resource_ref
FROM
\040\040\040\040resource
\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id
\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id
\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step_1\040ON\040achievement_step_1.id\040=\040achievement_step_1.id
\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id
WHERE
\040\040\040\040journey.id\040=\04030;
SELECT\040\040\040\040\040resource.ref\040AS\040resource_ref\040FROM\040\040\040\040\040resource\040\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id\040\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id\040\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step_1\040ON\040achievement_step_1.id\040=\040achievement_step_1.id\040\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id\040WHERE\040\040\040\040\040journey.id\040=\04030;
SELECT
\040\040\040\040resource.ref\040AS\040resource_ref
FROM
\040\040\040\040resource
\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id
\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id
\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id
\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id
WHERE
\040\040\040\040journey.id\040=\04030;
SELECT\040\040\040\040\040resource.ref\040AS\040resource_ref\040FROM\040\040\040\040\040resource\040\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id\040\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id\040\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id\040\040\040\040\040JOIN\040journey\040ON\040achievement_step_1.leg_id\040=\040journey.id\040WHERE\040\040\040\040\040journey.id\040=\04030;
SELECT
\040\040\040\040resource.ref\040AS\040resource_ref
FROM
\040\040\040\040resource
\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id
\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id
\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id
\040\040\040\040JOIN\040journey\040ON\040achievement_step.leg_id\040=\040journey.id
WHERE
\040\040\040\040journey.id\040=\04030;
SELECT\040\040\040\040\040resource.ref\040AS\040resource_ref\040FROM\040\040\040\040\040resource\040\040\040\040\040JOIN\040achievement_step_resource_list_item\040ON\040achievement_step_resource_list_item.resource_id\040=\040resource.id\040\040\040\040\040JOIN\040achievement_step_resource_list\040ON\040achievement_step_resource_list.id\040=\040achievement_step_resource_list_item.step_id\040\040\040\040\040JOIN\040achievement_step\040AS\040achievement_step\040ON\040achievement_step.id\040=\040achievement_step_resource_list.id\040\040\040\040\040JOIN\040journey\040ON\040achievement_step.leg_id\040=\040journey.id\040WHERE\040\040\040\040\040journey.id\040=\04030;
select\040id,\040title,\040image\040from\040programs\040where\040edition_id=71;
use\040nomadic;
select\040id,\040title,\040image\040from\040programs\040where\040edition_id=71;
use\040nomadic;
select\040*\040from\040survey_responses;
select\040*\040from\040survey_response;
show\040tables;
select\040*\040from\040survey_answer;
select\040edition_id\040from\040users\040where\040id=180345;
select\040edition_id,\040active,\040internal,\040deleted,\040from\040users\040where\040id=180345;
select\040edition_id,\040active,\040internal,\040deleted,\040sales_admin\040from\040users\040where\040id=180345;
@start_date\040=\040'2017-01-01'
@end_date\040=\040utc_timestamp()
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_1\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_2\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_3\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\040:param_4\040=\040users.edition_id
;
@start_date\040=\040'2017-01-01'\040@end_date\040=\040utc_timestamp()\040\040SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_1\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_2\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_3\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\040:param_4\040=\040users.edition_id;
@start_date\040=\040'2017-01-01';
@end_date\040=\040utc_timestamp();
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_1\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_2\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_3\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\040:param_4\040=\040users.edition_id
;
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_1\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_2\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_3\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\040:param_4\040=\040users.edition_id;
@start_date\040=\040'2017-01-01';
@end_date\040=\040utc_timestamp();
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_1\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_2\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_3\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\040:param_4\040=\040users.edition_id;
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_1\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_2\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040:param_3\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\040:param_4\040=\040users.edition_id;
@start_date\040=\040'2017-01-01';
@end_date\040=\040utc_timestamp();
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\040:param_4\040=\040users.edition_id;
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\040:param_4\040=\040users.edition_id;
@start_date\040=\040'2017-01-01';
@end_date\040=\040utc_timestamp();
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\04071\040=\040users.edition_id;
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\04071\040=\040users.edition_id;
set\040@start_date\040=\040'2017-01-01';
set\040@end_date\040=\040utc_timestamp();
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\04071\040=\040users.edition_id
;
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\04071\040=\040users.edition_id;
set\040@start_date\040=\040'2017-01-01';
set\040@end_date\040=\040utc_timestamp();
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\040users.id\040=\040180326
\040\040\040\040AND\04071\040=\040users.edition_id
;
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\040users.id\040=\040180326\040\040\040\040\040AND\04071\040=\040users.edition_id;
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
\040\040\040\040\040\040\040\040EXPLAIN
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
;
EXPLAIN\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
select\040created\040from\040editions\040where\040id=71;
EXPLAIN\040EXTENDED\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040EXTENDED\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;\040\040\040\040\040\040\040\040EXPLAIN\040EXTENDED
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
;
EXPLAIN\040EXTENDED\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
\040\040\040\040\040\040\040\040EXPLAIN\040EXTENDED
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040EXTENDED\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
show\040warnings;
EXPLAIN\040EXTENDED\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
show\040warnings;
show\040warnings\134G
\040\040\040\040\040\040\040\040EXPLAIN\040EXTENDED
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040EXTENDED\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040EXTENDED\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040EXTENDED\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040ANALYZE\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040ANALYZE\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\134g
EXPLAIN\040EXTENDED\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
;
EXPLAIN\040EXTENDED\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040ANALYSE\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
;
EXPLAIN\040ANALYSE\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040ANALYZE\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
;
EXPLAIN\040ANALYZE\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
ALTER\040TABLE\040view_time_log\040CREATE\040INDEX\040idx_user_times(user_id,\040first_view,\040last_view,\040time);
ALTER\040TABLE\040view_time_log\040ADD\040INDEX\040idx_user_times(user_id,\040first_view,\040last_view,\040time);
ALTER\040TABLE\040viewtimelog\040ADD\040INDEX\040idx_user_times(user_id,\040first_view,\040last_view,\040time);
EXPLAIN\040ANALYZE\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040ANALYZE\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
EXPLAIN\040ANALYZE\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id;
set\040@start_date\040=\040'2017-01-01';
set\040@end_date\040=\040utc_timestamp();
SELECT
\040\040\040\040users.*,
\040\040\040\040logins.*,
\040\040\040\040anon_1.ct\040AS\040anon_1_ct,
\040\040\040\040anon_2.ct\040AS\040anon_2_ct,
\040\040\040\040anon_3.ct\040AS\040anon_3_ct
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040resource_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_view
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id
WHERE
\040\040\040\040users.active\040=\0401
\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040AND\04071\040=\040users.edition_id;
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\04071\040=\040users.edition_id;
alter\040table\040resource_view\040add\040index\040idx_resource_view_user_times(user_id,\040viewed,\040view_time);
alter\040table\040community_view\040add\040index\040idx_community_view_user_times(user_id,\040viewed,\040view_time);
SELECT\040\040\040\040\040users.*,\040\040\040\040\040logins.*,\040\040\040\040\040anon_1.ct\040AS\040anon_1_ct,\040\040\040\040\040anon_2.ct\040AS\040anon_2_ct,\040\040\040\040\040anon_3.ct\040AS\040anon_3_ct\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(viewtimelog.time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040viewtimelog.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.first_view\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040viewtimelog.last_view\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040viewtimelog.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(resource_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040resource_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040resource_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040resource_view.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040sum(community_view.view_time)\040AS\040ct\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_view\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040users\040ON\040users.id\040=\040community_view.user_id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.viewed\040>\040@start_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_view.viewed\040<\040@end_date\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040AND\04071\040=\040users.edition_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040community_view.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users.id\040WHERE\040\040\040\040\040users.active\040=\0401\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040AND\04071\040=\040users.edition_id;
use\040nomadic;
show\040indexes\040from\040viewtimelog;
show\040indexes\040from\040communit_view;
show\040indexes\040from\040community_view;
show\040indexes\040from\040communit_view;
show\040indexes\040from\040viewtimelog;
select\040*\040from\040survey_responses;
select\040*\040from\040survey_response;
select\040*\040from\040survey_answer;
select\040*\040from\040profile_field_value\040where\040user_id=180345;
select\040*\040from\040users\040where\040user_id=180345;
select\040*\040from\040user\040where\040user_id=180345;
select\040*\040from\040users\040where\040id=180345;
select\040*\040from\040users\040where\040id=180345\134G
use\040nomadic;
select\040*\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=136;
select\040*\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36;
desc\040program_completion_log;
select\040sum(value)\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36;
select\040sum(value)\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040where\040posted\040>\040'2020-01-01';
select\040sum(value)\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040>\040'2020-01-01';
select\040user_id,\040last_name,\040sum(value)\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id;
select\040sum(value)\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040>\040'2020-01-01';
select\040user_id,\040last_name\040from\040program_completion_log\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040select\040user_id,\040last_name\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000;
select\040user_id,\040last_name\040from\040program_completion_log\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040(select\040user_id,\040last_name\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000);
select\040user_id,\040last_name\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040(select\040user_id,\040last_name\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000);
select\040user_id,\040last_name\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040(select\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000);
select\040user_id,\040last_name,\040sum(value)\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040(select\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000)\040group\040by\040user_id;
select\040user_id,\040first_name,\040last_name,\040sum(value)\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040(select\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000)\040group\040by\040user_id;
select\040user_id,\040first_name,\040last_name,\040sum(value)/60\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040(select\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=36\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000)\040group\040by\040user_id;
select\040sum(value)\040from\040program_completion_log\040where\040user_id=189942;
select\040sum(value)/60\040from\040program_completion_log\040where\040user_id=189942;
select\040*\040from\040profile_field_value\040where\040user+id=189942;
select\040*\040from\040profile_field_value\040where\040user_id=189942;
select\040sum(value)/60\040from\040viewtimelog\040where\040user_id=189942;
select\040sum(time)/60\040from\040viewtimelog\040where\040user_id=189942;
select\040sum(time)/60\040from\040viewtimelog\040where\040user_id=189942\040where\040first_view\040>\040'2020-01-01';
select\040sum(time)/60\040from\040viewtimelog\040where\040user_id=189942\040abd\040first_view\040>\040'2020-01-01';
select\040sum(time)/60\040from\040viewtimelog\040where\040user_id=189942\040and\040first_view\040>\040'2020-01-01';
select\040sum(time)/60\040from\040viewtimelog\040where\040user_id=189942;
select\040user_id,\040first_name,\040last_name,\040sum(value)/60\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040posted\040>\040'2020-01-01'\040and\040user_id\040in\040(select\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040users\040u\040on\040u.id=pcl.user_id\040where\040u.edition_id=71\040and\040posted\040<\040'2020-01-01'\040group\040by\040user_id\040having\040sum(value)\040>\0402000)\040group\040by\040user_id;
select\040sum(time)/60\040from\040viewtimelog\040where\040user_id=248521;
select\040sum(time)/60\040from\040viewtimelog\040where\040user_id=248521\040and\040first_view\040>\040'2020-01-01';
select\040*\040from\040excel_group_report\040where\040id=12439;
select\040*\040from\040excel_group_report\040where\040id=12439\134G
select\040*\040from\040excel_group_report\040order\040by\040id\040desc\040limit\0401\134G
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration."when"\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9."when"\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_1\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_2\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment."when")\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040:param_3\040=\040users_1.edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration."when",
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration."when"\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9."when"\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_1\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_2\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment."when")\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040:param_3\040=\040users_1.edition_id\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration."when",\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration."when"\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_1\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_2\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040:param_3\040=\040users_1.edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration."when"\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_1\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_2\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040:param_3\040=\040users_1.edition_id\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_1\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_2\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040:param_3\040=\040users_1.edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_1\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040:param_2\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040:param_3\040=\040users_1.edition_id\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\04011\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\04011\040=\040users.edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\04011\040=\040users_1.edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\04011\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\04011\040=\040users.edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\04011\040=\040users_1.edition_id\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\04011
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040users_1.edition_id\040=\04011\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groups.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when"
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when"\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when"
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when"\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groups\040ON\040groups.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040u.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040gu.added\040AS\040"when"
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040u\040
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groupusers\040gu\040ON\040u.id\040=\040gu.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040u.edition_id\040=\04011;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040u.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040gu.added\040AS\040"when"\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040u\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groupusers\040gu\040ON\040u.id\040=\040gu.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040inner\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040u.edition_id\040=\04011;
SELECT
\040\040\040\040u.id\040AS\040user_id,
\040\040\040\040gu.added\040AS\040"when"
FROM
\040\040\040\040users\040u\040
\040\040\040\040inner\040JOIN\040groupusers\040gu\040ON\040u.id\040=\040gu.user_id
\040\040\040\040inner\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id
WHERE
\040\040\040\040u.edition_id\040=\04011;
SELECT\040\040\040\040\040u.id\040AS\040user_id,\040\040\040\040\040gu.added\040AS\040"when"\040FROM\040\040\040\040\040users\040u\040\040\040\040\040\040inner\040JOIN\040groupusers\040gu\040ON\040u.id\040=\040gu.user_id\040\040\040\040\040inner\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id\040WHERE\040\040\040\040\040u.edition_id\040=\04011;
SELECT
\040\040\040\040u.id,
\040\040\040\040gu.added
FROM
\040\040\040\040users\040u\040
\040\040\040\040inner\040JOIN\040groupusers\040gu\040ON\040u.id\040=\040gu.user_id
\040\040\040\040inner\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id
WHERE
\040\040\040\040u.edition_id\040=\04011;
SELECT\040\040\040\040\040u.id,\040\040\040\040\040gu.added\040FROM\040\040\040\040\040users\040u\040\040\040\040\040\040inner\040JOIN\040groupusers\040gu\040ON\040u.id\040=\040gu.user_id\040\040\040\040\040inner\040JOIN\040groups\040g\040ON\040g.id\040=\040gu.group_id\040WHERE\040\040\040\040\040u.edition_id\040=\04011;
select\040gu.user_id\040from\040users\040u\040inner\040join\040groupusers\040gu\040on\040gu.user_id=u.id;
select\040gu.user_id\040from\040users\040u\040inner\040join\040groupusers\040gu\040on\040gu.user_id=u.id\040inner\040join\040groups\040g\040on\040g.id=gu.group_id;
desc\040groups
;
desc\040group;
desc\040`groups`;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_`groups`\040AS\040anon_2_number_`groups`,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_`groups`
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\04011
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_`groups`,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_`groups`\040AS\040anon_2_number_`groups`,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_`groups`\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040users_1.edition_id\040=\04011\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_`groups`,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\04011
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040:value_1\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040users_1.edition_id\040=\04011\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\04011
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\04011\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040users_1.edition_id\040=\04011\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
set\040@edition_id\040=\04047
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\040@edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
set\040@edition_id\040=\04047\040\040SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040users_1.edition_id\040=\040@edition_id\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
set\040@edition_id\040=\04047;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\040@edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040users_1.edition_id\040=\040@edition_id\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
set\040@edition_id\040=\04049;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\040@edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
SELECT\040\040\040\040\040users_1.id\040AS\040users_1_id,\040\040\040\040\040users_1.first_name\040AS\040users_1_first_name,\040\040\040\040\040users_1.last_name\040AS\040users_1_last_name,\040\040\040\040\040logins.email\040AS\040logins_email,\040\040\040\040\040registration.`when`\040AS\040registration_when,\040\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,\040\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,\040\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,\040\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,\040\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed\040FROM\040\040\040\040\040users\040\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id\040\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id\040\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id\040\040\040\040\040LEFT\040OUTER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id\040WHERE\040\040\040\040\040users_1.edition_id\040=\040@edition_id\040\040\040\040\040AND\040users_1.active\040=\0401\040\040\040\040\040AND\040users_1.internal\040=\0400\040\040\040\040\040AND\040users_1.sales_admin\040=\0400\040\040\040\040\040AND\040users_1.deleted\040IS\040NULL\040GROUP\040BY\040\040\040\040\040users_1.id,\040\040\040\040\040logins.email,\040\040\040\040\040registration.`when`,\040\040\040\040\040anon_1.number_enrolments,\040\040\040\040\040anon_2.number_groups,\040\040\040\040\040anon_3.number_opened_program,\040\040\040\040\040anon_6.number_programs_completed\040ORDER\040BY\040\040\040\040\040logins.email;
set\040@edition_id\040=\0408;
SELECT
\040\040\040\040users_1.id\040AS\040users_1_id,
\040\040\040\040users_1.first_name\040AS\040users_1_first_name,
\040\040\040\040users_1.last_name\040AS\040users_1_last_name,
\040\040\040\040logins.email\040AS\040logins_email,
\040\040\040\040registration.`when`\040AS\040registration_when,
\040\040\040\040anon_1.number_enrolments\040AS\040anon_1_number_enrolments,
\040\040\040\040anon_2.number_groups\040AS\040anon_2_number_groups,
\040\040\040\040anon_3.number_opened_program\040AS\040anon_3_number_opened_program,
\040\040\040\040sum(anon_5.program_completion)\040/\040anon_3.number_opened_program\040AS\040anon_4,
\040\040\040\040anon_6.number_programs_completed\040AS\040anon_6_number_programs_completed
FROM
\040\040\040\040users
\040\040\040\040JOIN\040logins\040ON\040logins.id\040=\040users.login_id
\040\040\040\040LEFT\040OUTER\040JOIN\040users\040AS\040users_1\040ON\040users_1.id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040registration\040ON\040registration.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(anon_7.program_id)\040AS\040number_enrolments
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_8.program_id)\040AS\040program_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.`when`\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_9.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040groupusers.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groupusers\040ON\040users.id\040=\040groupusers.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session_user.added\040AS\040"when",
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_session.end_date\040AS\040end_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session_user\040ON\040users.id\040=\040program_session_user.user_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040program_session\040ON\040program_session.id\040=\040program_session_user.session_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040users.edition_id\040=\040@edition_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_9
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_8
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040anon_8.program_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_7
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_7.user_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(groupusers.group_id)\040AS\040number_groups
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040groupusers
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040`groups`.id\040=\040groupusers.group_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040groupusers.user_id
\040\040\040\040)\040AS\040anon_2\040ON\040anon_2.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(enrolment.`when`)\040AS\040number_opened_program
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040enrolment
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040enrolment.user_id
\040\040\040\040)\040AS\040anon_3\040ON\040anon_3.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040program_completion
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.group_id
\040\040\040\040)\040AS\040anon_5\040ON\040anon_5.user_id\040=\040users_1.id
\040\040\040\040LEFT\040OUTER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040count(program_completion_log.value)\040AS\040number_programs_completed
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.value\040=\040100
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040)\040AS\040anon_6\040ON\040anon_6.user_id\040=\040users_1.id
WHERE
\040\040\040\040users_1.edition_id\040=\040@edition_id
\040\040\040\040AND\040users_1.active\040=\0401
\040\040\040\040AND\040users_1.internal\040=\0400
\040\040\040\040AND\040users_1.sales_admin\040=\0400
\040\040\040\040AND\040users_1.deleted\040IS\040NULL
GROUP\040BY
\040\040\040\040users_1.id,
\040\040\040\040logins.email,
\040\040\040\040registration.`when`,
\040\040\040\040anon_1.number_enrolments,
\040\040\040\040anon_2.number_groups,
\040\040\040\040anon_3.number_opened_program,
\040\040\040\040anon_6.number_programs_completed
ORDER\040BY
\040\040\040\040logins.email;
use\040nomadic;
show\040processlist
;
kill\040query\0409;
show\040processlist
;
use\040nomadic;
show\040processlist;
use\040nomadic;
show\040processlist;
kill\040query\04014;
show\040processlist;
kill\040query\04055;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date\040\134\040nFROM\040users,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id\040\134\040nWHERE\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date\040\134\040nFROM\040users,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id\040\134\040nWHERE\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id;
SELECT
\040\040\040\040programs.title\040AS\040programs_title,
\040\040\040\040anon_1.avg_completion\040AS\040anon_1_avg_completion,
\040\040\040\040anon_1.latest_completion_date\040AS\040anon_1_latest_completion_date,
\040\040\040\040anon_1.users_started\040AS\040anon_1_users_started
\040\040\040\040FROM\040programs
\040\040\040\040INNER\040JOIN\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_2.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040coalesce(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040sum(anon_2.latest_completion_value)\040/\040count(anon_2.latest_completion_value)
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040/\040100,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\0400
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040avg_completion,
\040\040\040\040\040\040\040\040\040\040\040\040max(anon_2.latest_completion_date)\040AS\040latest_completion_date,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(anon_2.user_id))\040AS\040users_started
\040\040\040\040\040\040\040\040\040\040\040\040FROM\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040users,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_2
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_2.program_id
\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.program_id\040=\040programs.id
\040\040\040\040WHERE\040programs.edition_id\040=\04011;
SELECT\040\040\040\040\040programs.title\040AS\040programs_title,\040\040\040\040\040anon_1.avg_completion\040AS\040anon_1_avg_completion,\040\040\040\040\040anon_1.latest_completion_date\040AS\040anon_1_latest_completion_date,\040\040\040\040\040anon_1.users_started\040AS\040anon_1_users_started\040\040\040\040\040FROM\040programs\040\040\040\040\040INNER\040JOIN\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_2.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040coalesce(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040sum(anon_2.latest_completion_value)\040/\040count(anon_2.latest_completion_value)\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040/\040100,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\0400\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040avg_completion,\040\040\040\040\040\040\040\040\040\040\040\040\040max(anon_2.latest_completion_date)\040AS\040latest_completion_date,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(anon_2.user_id))\040AS\040users_started\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040users,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_2\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_2.program_id\040\040\040\040\040)\040AS\040anon_1\040ON\040anon_1.program_id\040=\040programs.id\040\040\040\040\040WHERE\040programs.edition_id\040=\04011;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040users,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040users,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id;
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id\040AS\040program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040users,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=49\040AND\040users.active\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id;
`groups`.program_id\040AS\040program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.value)\040AS\040latest_completion_value,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(program_completion_log.posted)\040AS\040latest_completion_date\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040users,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040INNER\040JOIN\040`groups`\040ON\040`groups`.id\040=\040program_completion_log.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040WHERE\040users.edition_id=49\040AND\040users.active\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.internal\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.sales_admin\040=\0400\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040users.deleted\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040`groups`.program_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040program_completion_log.user_id;
show\040processlist;
kill\040query\04062;
show\040processlist;
kill\040query\04072;
select\040distinct\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040groups\040g\040on\040g.id=pcl.group_id\040where\040g.program_id=17;
select\040count(*)\040from\040program_completion_log\040pcl\040inner\040join\040groups\040g\040on\040g.id=pcl.group_id\040where\040g.program_id=17;
select\040count(*)\040from\040program_completion_log\040pcl'
';
select\040count(*)\040from\040program_completion_log\040pcl'\012';
select\040count(*)\040from\040program_completion_log\040pcl';
'
;
select\040count(*)\040from\040program_completion_log\040pcl';\012';
select\040count(*)\040from\040program_completion_log\040pcl;
select\040count(*)\040from\040program_completion_log\040pcl\040inner\040join\040groups\040g\040on\040g.id=pcl.group_id;
select\040count(*)\040from\040program_completion_log\040pcl\040inner\040join\040`groups`\040g\040on\040g.id=pcl.group_id;
select\040count(*)\040from\040program_completion_log\040pcl\040inner\040join\040`groups`\040g\040on\040g.id=pcl.group_id\040where\040g.program_id=17;
select\040distinct\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040groups\040g\040on\040g.id=pcl.group_id\040where\040g.program_id=17;
select\040distinct\040user_id\040from\040program_completion_log\040pcl\040inner\040join\040`groups`\040g\040on\040g.id=pcl.group_id\040where\040g.program_id=17;
use\040nomadic;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040s.id,\040s.title,\040anon_3.segment_id\040AS\040segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040coalesce(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040sum(anon_3.latest_completion_value)\040/\040count(anon_3.latest_completion_value)\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040/\040100,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\0400\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040avg_completion,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(anon_3.user_id))\040AS\040users_started\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id\040AS\040segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040AS\040group_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(completionlog.value)\040AS\040latest_completion_value\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_3\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040anon_3.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040segments\040s\040on\040s.id=anon_3.segment_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id;
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id\040AS\040segment_id,
\040\040\040\040\040\040\040\040\040\040\040\040coalesce(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040sum(anon_3.latest_completion_value)\040/\040count(anon_3.latest_completion_value)
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040/\040100,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\0400
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040avg_completion,
\040\040\040\040\040\040\040\040\040\040\040\040max(timedrelease.release_date)\040AS\040latest_release_date,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(anon_3.user_id))\040AS\040users_started
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id\040AS\040segment_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040AS\040group_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(completionlog.value)\040AS\040latest_completion_value
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_3
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040anon_3.group_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040timedrelease\040ON\040timedrelease.group_id\040=\040groups.id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040segments\040s\040on\040s.id=anon_3.segment_id
\040\040\040\040\040\040\040\040\040\040\040\040AND\040timedrelease.segment_id\040=\040anon_3.segment_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id\040AS\040segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040coalesce(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040sum(anon_3.latest_completion_value)\040/\040count(anon_3.latest_completion_value)\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040/\040100,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\0400\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040avg_completion,\040\040\040\040\040\040\040\040\040\040\040\040\040max(timedrelease.release_date)\040AS\040latest_release_date,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(anon_3.user_id))\040AS\040users_started\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id\040AS\040segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040AS\040group_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(completionlog.value)\040AS\040latest_completion_value\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_3\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040groups\040ON\040groups.id\040=\040anon_3.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040timedrelease\040ON\040timedrelease.group_id\040=\040groups.id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040segments\040s\040on\040s.id=anon_3.segment_id\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040timedrelease.segment_id\040=\040anon_3.segment_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id;
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id\040AS\040segment_id,
\040\040\040\040\040\040\040\040\040\040\040\040coalesce(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040sum(anon_3.latest_completion_value)\040/\040count(anon_3.latest_completion_value)
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040/\040100,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\0400
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040avg_completion,
\040\040\040\040\040\040\040\040\040\040\040\040max(timedrelease.release_date)\040AS\040latest_release_date,
\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(anon_3.user_id))\040AS\040users_started
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id\040AS\040segment_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040AS\040group_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id\040AS\040user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(completionlog.value)\040AS\040latest_completion_value
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id,
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id
\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_3
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040groups.id\040=\040anon_3.group_id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040timedrelease\040ON\040timedrelease.group_id\040=\040groups.id
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040segments\040s\040on\040s.id=anon_3.segment_id
\040\040\040\040\040\040\040\040\040\040\040\040AND\040timedrelease.segment_id\040=\040anon_3.segment_id
\040\040\040\040\040\040\040\040GROUP\040BY
\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id;
SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id\040AS\040segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040coalesce(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040sum(anon_3.latest_completion_value)\040/\040count(anon_3.latest_completion_value)\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040)\040/\040100,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\0400\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040avg_completion,\040\040\040\040\040\040\040\040\040\040\040\040\040max(timedrelease.release_date)\040AS\040latest_release_date,\040\040\040\040\040\040\040\040\040\040\040\040\040count(distinct(anon_3.user_id))\040AS\040users_started\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id\040AS\040segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040AS\040group_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id\040AS\040user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040max(completionlog.value)\040AS\040latest_completion_value\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.segment_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.user_id,\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040completionlog.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040)\040AS\040anon_3\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040`groups`\040ON\040groups.id\040=\040anon_3.group_id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040timedrelease\040ON\040timedrelease.group_id\040=\040groups.id\040\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040segments\040s\040on\040s.id=anon_3.segment_id\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040timedrelease.segment_id\040=\040anon_3.segment_id\040\040\040\040\040\040\040\040\040GROUP\040BY\040\040\040\040\040\040\040\040\040\040\040\040\040anon_3.segment_id;
select\040s.title,\040s.id\040from\040segments\040s\040where\040s.title='The\040Virtual\040Context';
select\040s.title,\040s.id\040from\040segments\040s\040inner\040join\040program_segments\040ps\040on\040ps.segment_id=s.id\040inner\040join\040programs\040p\040on\040p.id=ps.program_id\040where\040p.title='virtual\040teams';
select\040p.id,\040s.title,\040s.id\040from\040segments\040s\040inner\040join\040program_segments\040ps\040on\040ps.segment_id=s.id\040inner\040join\040programs\040p\040on\040p.id=ps.program_id\040where\040p.title='virtual\040teams';
select\040count(*)\040from\040completionlog\040cl\040inner\040join\040`groups`\040g\040on\040g.program_id=p.id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040where\040segment_id=239\040and\040p.id=17;
select\040count(*)\040from\040completionlog\040cl\040inner\040join\040`groups`\040g\040on\040g.id=cl.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040where\040segment_id=239\040and\040p.id=17;
select\040count(distinct\040user_id)\040from\040completionlog\040cl\040inner\040join\040`groups`\040g\040on\040g.id=cl.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040where\040segment_id=239\040and\040p.id=17;
select\040count(distinct\040user_id)\040from\040program_completion_log\040pcl\040inner\040join\040`groups`\040g\040on\040g.id=pcl.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040where\040segment_id=239\040and\040p.id=17;
select\040count(distinct\040user_id)\040from\040program_completion_log\040pcl\040inner\040join\040`groups`\040g\040on\040g.id=pcl.group_id\040inner\040join\040programs\040p\040on\040p.id=g.program_id\040where\040p.id=17;
use\040nomadic;
select\040seats,\040name\040from\040platform_subscription\040where\040seats>100;
select\040seats,\040name\040from\040platform_subscription\040where\040seats>100\040and\040edition_id=71;
use\040nomadic;
select\040seats,\040name\040from\040platform_subscription\040where\040seats>100\040and\040edition_id=71;
select\040seats,\040name,\040active\040from\040platform_subscription\040where\040seats>100\040and\040edition_id=71;
use\040nomadic;
select\040*\040from\040users\040where\040id=180345;
select\040*\040from\040users\040where\040id=180345\134G
begin;
update\040users\040set\040admin=0,\040sales_admin=0,\040admin_analytics=0\040where\040id=180345;
commit;
select\040*\040from\040community_channel\040where\040edition_id=71;
select\040*\040from\040community_channel\040where\040edition_id=71\134G
select\040id\040from\040community_channel\040where\040edition_id=71\134G
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=180345;
select\040id,\040count(*)\040from\040community_channel\040cc\040inner\040join\040community_post\040cp\040on\040cp.channel_id=cc.id\040where\040edition_id=71\134G
select\040cc.id,\040count(*)\040from\040community_channel\040cc\040inner\040join\040community_post\040cp\040on\040cp.channel_id=cc.id\040where\040edition_id=71\040group\040by\040cc.id\040\134G
select\040cc.id,\040count(*)\040from\040community_channel\040cc\040inner\040join\040community_post\040cp\040on\040cp.channel_id=cc.id\040where\040cc.edition_id=71\040group\040by\040cc.id\040\134G
select\040cc.id,\040count(*)\040from\040community_channel\040cc\040inner\040join\040community_post\040cp\040on\040cp.channel_id=cc.id\040where\040cc.edition_id=71\040group\040by\040cc.id;
update\040users\040set\040admin=0,\040sales_admin=0,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=0,\040sales_admin=0,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=0,\040sales_admin=0,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=0,\040sales_admin=0,\040admin_analytics=0\040where\040id=180345;
delete\040from\040community_channel_user\040where\040user_id=180345\040and\040channel_id=1476;
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=0,\040sales_admin=0,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=180345;
delete\040from\040community_channel_user\040where\040user_id=180345\040and\040channel_id=1475;
update\040users\040set\040admin=0,\040sales_admin=0,\040admin_analytics=0\040where\040id=180345;
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=180345;
select\040id\040from\040editions\040where\040community_edition_id=71;
select\040id,\040name\040from\040editions\040where\040community_edition_id=71;
update\040users\040set\040admin=1,\040sales_admin=1,\040admin_analytics=0\040where\040id=398210;
use\040nomadic;
select\040*\040from\040community_channel;
select\040id,\040title\040from\040community_channel;
select\040id,\040title,\040edition_id\040from\040community_channel;
select\040cc.id,\040title,\040edition_id,\040e.name\040from\040community_channel\040cc\040inner\040join\040edition\040e\040on\040e.id=cc.edition_id;
select\040cc.id,\040title,\040edition_id,\040e.name\040from\040community_channel\040cc\040inner\040join\040editions\040e\040on\040e.id=cc.edition_id;
select\040cc.id,\040title,\040edition_id,\040e.name\040from\040community_channel\040cc\040inner\040join\040editions\040e\040on\040e.id=cc.edition_id\040where\040name\040like\040'%nab%';
select\040cc.id,\040title,\040private,\040edition_id,\040e.name\040from\040community_channel\040cc\040inner\040join\040editions\040e\040on\040e.id=cc.edition_id\040where\040name\040like\040'%nab%';
desc\040community_channel;
select\040cc.id,\040title,\040public,\040edition_id,\040e.name\040from\040community_channel\040cc\040inner\040join\040editions\040e\040on\040e.id=cc.edition_id\040where\040name\040like\040'%nab%';
begin;
update\040community_channel\040set\040public=1\040where\040id=1382;
commit;
use\040nomadic;
SELECT
\040\040\040\040anon_1.community_post_text\040AS\040anon_1_community_post_text,
\040\040\040\040anon_1.community_post_id\040AS\040anon_1_community_post_id,
\040\040\040\040anon_1.community_post_author_id\040AS\040anon_1_community_post_author_id,
\040\040\040\040anon_1.community_post_edition_id\040AS\040anon_1_community_post_edition_id,
\040\040\040\040anon_1.community_post_title\040AS\040anon_1_community_post_title,
\040\040\040\040anon_1.community_post_created\040AS\040anon_1_community_post_created,
\040\040\040\040anon_1.community_post_channel_id\040AS\040anon_1_community_post_channel_id,
\040\040\040\040anon_1.community_post_expert_post\040AS\040anon_1_community_post_expert_post,
\040\040\040\040anon_1.community_post_expert_post_image\040AS\040anon_1_community_post_expert_post_image,
\040\040\040\040anon_1.community_post_surfaced_content\040AS\040anon_1_community_post_surfaced_content,
\040\040\040\040anon_1.community_post_surfaced_content_type\040AS\040anon_1_community_post_surfaced_content_type,
\040\040\040\040anon_1.community_post_surfaced_content_prompt_title\040AS\040anon_1_community_post_surfaced_content_prompt_title,
\040\040\040\040anon_1.community_post_surfaced_content_prompt_text\040AS\040anon_1_community_post_surfaced_content_prompt_text,
\040\040\040\040anon_1.community_post_surfaced_content_url\040AS\040anon_1_community_post_surfaced_content_url,
\040\040\040\040anon_1.community_post_surfaced_content_text\040AS\040anon_1_community_post_surfaced_content_text,
\040\040\040\040anon_1.community_post_surfaced_content_fm\040AS\040anon_1_community_post_surfaced_content_fm,
\040\040\040\040anon_1.community_post_surfaced_content_program\040AS\040anon_1_community_post_surfaced_content_program,
\040\040\040\040anon_1.community_post_surfaced_content_author_id\040AS\040anon_1_community_post_surfaced_content_author_id,
\040\040\040\040anon_1.community_post_card\040AS\040anon_1_community_post_card,
\040\040\040\040anon_1.community_post_card_title\040AS\040anon_1_community_post_card_title,
\040\040\040\040anon_1.community_post_card_url\040AS\040anon_1_community_post_card_url,
\040\040\040\040anon_1.community_post_card_image\040AS\040anon_1_community_post_card_image,
\040\040\040\040anon_1.community_post_pinned\040AS\040anon_1_community_post_pinned
FROM
\040\040\040\040(
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_post.text\040AS\040community_post_text,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.id\040AS\040community_post_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.author_id\040AS\040community_post_author_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.edition_id\040AS\040community_post_edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.title\040AS\040community_post_title,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.created\040AS\040community_post_created,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.channel_id\040AS\040community_post_channel_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post\040AS\040community_post_expert_post,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post_image\040AS\040community_post_expert_post_image,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content\040AS\040community_post_surfaced_content,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_type\040AS\040community_post_surfaced_content_type,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_title\040AS\040community_post_surfaced_content_prompt_title,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_text\040AS\040community_post_surfaced_content_prompt_text,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_url\040AS\040community_post_surfaced_content_url,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_text\040AS\040community_post_surfaced_content_text,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_fm\040AS\040community_post_surfaced_content_fm,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_program\040AS\040community_post_surfaced_content_program,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_author_id\040AS\040community_post_surfaced_content_author_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card\040AS\040community_post_card,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_title\040AS\040community_post_card_title,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_url\040AS\040community_post_card_url,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_image\040AS\040community_post_card_image,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.pinned\040AS\040community_post_pinned
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_post
\040\040\040\040\040\040\040\040\040\040\040\040LEFT\040OUTER\040JOIN\040community_channel\040ON\040community_post.channel_id\040=\040community_channel.id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_post.id\040IN\040(:id_1)
\040\040\040\040\040\040\040\040\040\040\040\040AND\040(
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.channel_id\040IS\040NULL
\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040OR\040community_channel.public\040=\0401
\040\040\040\040\040\040\040\040\040\040\040\040)
\040\040\040\040\040\040\040\040UNION
\040\040\040\040\040\040\040\040ALL
\040\040\040\040\040\040\040\040SELECT
\040\040\040\040\040\040\040\040\040\040\040\040community_post.text\040AS\040community_post_text,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.id\040AS\040community_post_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.author_id\040AS\040community_post_author_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.edition_id\040AS\040community_post_edition_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.title\040AS\040community_post_title,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.created\040AS\040community_post_created,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.channel_id\040AS\040community_post_channel_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post\040AS\040community_post_expert_post,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post_image\040AS\040community_post_expert_post_image,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content\040AS\040community_post_surfaced_content,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_type\040AS\040community_post_surfaced_content_type,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_title\040AS\040community_post_surfaced_content_prompt_title,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_text\040AS\040community_post_surfaced_content_prompt_text,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_url\040AS\040community_post_surfaced_content_url,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_text\040AS\040community_post_surfaced_content_text,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_fm\040AS\040community_post_surfaced_content_fm,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_program\040AS\040community_post_surfaced_content_program,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_author_id\040AS\040community_post_surfaced_content_author_id,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card\040AS\040community_post_card,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_title\040AS\040community_post_card_title,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_url\040AS\040community_post_card_url,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_image\040AS\040community_post_card_image,
\040\040\040\040\040\040\040\040\040\040\040\040community_post.pinned\040AS\040community_post_pinned
\040\040\040\040\040\040\040\040FROM
\040\040\040\040\040\040\040\040\040\040\040\040community_post
\040\040\040\040\040\040\040\040\040\040\040\040JOIN\040community_channel\040ON\040community_channel.id\040=\040community_post.channel_id
\040\040\040\040\040\040\040\040WHERE
\040\040\040\040\040\040\040\040\040\040\040\040community_post.id\040IN\040(:id_2)
\040\040\040\040\040\040\040\040\040\040\040\040AND\040community_channel.public\040=\0400
\040\040\040\040)\040AS\040anon_1
WHERE
\040\040\040\04071\040=\040anon_1.community_post_edition_id;
SELECT\040\040\040\040\040anon_1.community_post_text\040AS\040anon_1_community_post_text,\040\040\040\040\040anon_1.community_post_id\040AS\040anon_1_community_post_id,\040\040\040\040\040anon_1.community_post_author_id\040AS\040anon_1_community_post_author_id,\040\040\040\040\040anon_1.community_post_edition_id\040AS\040anon_1_community_post_edition_id,\040\040\040\040\040anon_1.community_post_title\040AS\040anon_1_community_post_title,\040\040\040\040\040anon_1.community_post_created\040AS\040anon_1_community_post_created,\040\040\040\040\040anon_1.community_post_channel_id\040AS\040anon_1_community_post_channel_id,\040\040\040\040\040anon_1.community_post_expert_post\040AS\040anon_1_community_post_expert_post,\040\040\040\040\040anon_1.community_post_expert_post_image\040AS\040anon_1_community_post_expert_post_image,\040\040\040\040\040anon_1.community_post_surfaced_content\040AS\040anon_1_community_post_surfaced_content,\040\040\040\040\040anon_1.community_post_surfaced_content_type\040AS\040anon_1_community_post_surfaced_content_type,\040\040\040\040\040anon_1.community_post_surfaced_content_prompt_title\040AS\040anon_1_community_post_surfaced_content_prompt_title,\040\040\040\040\040anon_1.community_post_surfaced_content_prompt_text\040AS\040anon_1_community_post_surfaced_content_prompt_text,\040\040\040\040\040anon_1.community_post_surfaced_content_url\040AS\040anon_1_community_post_surfaced_content_url,\040\040\040\040\040anon_1.community_post_surfaced_content_text\040AS\040anon_1_community_post_surfaced_content_text,\040\040\040\040\040anon_1.community_post_surfaced_content_fm\040AS\040anon_1_community_post_surfaced_content_fm,\040\040\040\040\040anon_1.community_post_surfaced_content_program\040AS\040anon_1_community_post_surfaced_content_program,\040\040\040\040\040anon_1.community_post_surfaced_content_author_id\040AS\040anon_1_community_post_surfaced_content_author_id,\040\040\040\040\040anon_1.community_post_card\040AS\040anon_1_community_post_card,\040\040\040\040\040anon_1.community_post_card_title\040AS\040anon_1_community_post_card_title,\040\040\040\040\040anon_1.community_post_card_url\040AS\040anon_1_community_post_card_url,\040\040\040\040\040anon_1.community_post_card_image\040AS\040anon_1_community_post_card_image,\040\040\040\040\040anon_1.community_post_pinned\040AS\040anon_1_community_post_pinned\040FROM\040\040\040\040\040(\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.text\040AS\040community_post_text,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.id\040AS\040community_post_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.author_id\040AS\040community_post_author_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.edition_id\040AS\040community_post_edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.title\040AS\040community_post_title,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.created\040AS\040community_post_created,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.channel_id\040AS\040community_post_channel_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post\040AS\040community_post_expert_post,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post_image\040AS\040community_post_expert_post_image,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content\040AS\040community_post_surfaced_content,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_type\040AS\040community_post_surfaced_content_type,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_title\040AS\040community_post_surfaced_content_prompt_title,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_text\040AS\040community_post_surfaced_content_prompt_text,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_url\040AS\040community_post_surfaced_content_url,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_text\040AS\040community_post_surfaced_content_text,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_fm\040AS\040community_post_surfaced_content_fm,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_program\040AS\040community_post_surfaced_content_program,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_author_id\040AS\040community_post_surfaced_content_author_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.card\040AS\040community_post_card,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_title\040AS\040community_post_card_title,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_url\040AS\040community_post_card_url,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.card_image\040AS\040community_post_card_image,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.pinned\040AS\040community_post_pinned\040\040\040\040\040\040\040\040\040FROM\040\040\040\040\040\040\040\040\040\040\040\040\040community_post\040\040\040\040\040\040\040\040\040\040\040\040\040LEFT\040OUTER\040JOIN\040community_channel\040ON\040community_post.channel_id\040=\040community_channel.id\040\040\040\040\040\040\040\040\040WHERE\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.id\040IN\040(:id_1)\040\040\040\040\040\040\040\040\040\040\040\040\040AND\040(\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.channel_id\040IS\040NULL\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040OR\040community_channel.public\040=\0401\040\040\040\040\040\040\040\040\040\040\040\040\040)\040\040\040\040\040\040\040\040\040UNION\040\040\040\040\040\040\040\040\040ALL\040\040\040\040\040\040\040\040\040SELECT\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.text\040AS\040community_post_text,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.id\040AS\040community_post_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.author_id\040AS\040community_post_author_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.edition_id\040AS\040community_post_edition_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.title\040AS\040community_post_title,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.created\040AS\040community_post_created,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.channel_id\040AS\040community_post_channel_id,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post\040AS\040community_post_expert_post,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.expert_post_image\040AS\040community_post_expert_post_image,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content\040AS\040community_post_surfaced_content,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_type\040AS\040community_post_surfaced_content_type,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_title\040AS\040community_post_surfaced_content_prompt_title,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_prompt_text\040AS\040community_post_surfaced_content_prompt_text,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_url\040AS\040community_post_surfaced_content_url,\040\040\040\040\040\040\040\040\040\040\040\040\040community_post.surfaced_content_text\040AS\040community_post_s
